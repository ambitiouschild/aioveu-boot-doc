

# 1.后端

1. 单个查询：直接使用数据库查询，不需要 Map
2. 批量查询：使用 Map 可以提高效率，减少数据库访问次数
3. 根据实际需求选择：不是所有场景都需要使用 Map，要根据数据量和查询模式决定

在您的保存部门场景中，由于是处理单个表单的保存操作，使用单个查询是合适的选择。如果您需要处理批量导入或多个部门同时保存，那么使用 Map 进行批量查询会更高效。

|      | 单次查询（）   | 批量查询（Map）       |
| ---- | :------------- | --------------------- |
|      |                | 1.获取分页列表        |
|      | 2.获取表单数据 |                       |
|      | 3.新增数据     |                       |
|      | 4.更新数据     |                       |
|      | 5.删除数据     |                       |
|      |                | 6.获取表单数据（Map） |



## 1.1.批量查询

### 1.1.1.获取分页列表（批量查询Map）

【getDepartment  + Service】批量查询Map方法【】

```
    /**
     * 批量获取部门信息（新增方法）
     */
    Map<Long, String> getDepartmentMapByIds(List<Long> deptIds);

```





```
    /**
     * 批量获取部门信息（新增方法）
     */
    @Override
    public Map<Long, String> getDepartmentMapByIds(List<Long> deptIds) {
        if (deptIds == null || deptIds.isEmpty()) {
            return Map.of();
        }

        // 批量查询部门信息
        List<AioveuDepartment> departments = this.listByIds(deptIds);
        
                // 使用 LambdaQueryWrapper，编译时安全
//        List<AioveuEmployee> employees = lambdaQuery()
//                .select(AioveuEmployee::getEmployeeId, AioveuEmployee::getName)
//                .in(AioveuEmployee::getEmployeeId, employeeIds)
//                .list();

        // 转换为Map: key=部门ID, value=部门名称
        return departments.stream()
                .collect(Collectors.toMap(
                        AioveuDepartment::getDeptId,
                        AioveuDepartment::getDeptName
                ));
    }
```

```
    /**
     * 获取所有部门列表（用于下拉选择框）
     *
     * @return 部门选项列表
     */
    @Override
    public List<DeptOptionVO> getAllDepartmentOptions() {
        // 查询所有部门
        List<AioveuDepartment> departments = this.list();

        // 转换为选项对象
        List<DeptOptionVO>  deptOptionVO  = departments.stream()
                .map(dept -> new DeptOptionVO(dept.getDeptId(), dept.getDeptName()))
                .collect(Collectors.toList());

        return deptOptionVO;
    }
```

【getDepartment  + Controller】批量查询接口【】

```
    /**
     * 根据部门ID列表获取部门名称映射
     * @param deptIds 部门ID列表
     * @return 部门ID到部门名称的映射
     */
    @Operation(summary = "根据部门ID列表获取部门名称映射")
    @PostMapping("/map")
    public Result<Map<Long, String>> getDepartmentMapByIds(@RequestBody List<Long> deptIds) {
        Map<Long, String> departmentMap = aioveuDepartmentService.getDepartmentMapByIds(deptIds);
        return Result.success(departmentMap);
    }
```



```
    /**
     * 获取所有部门列表（用于下拉选择框）
     * @return 部门选项列表
     */
    @Operation(summary = "获取所有部门列表（用于下拉选择框）")
    @GetMapping("/options")
    public Result<List<DeptOptionVO>> getAllDepartmentOptions() {

        List<DeptOptionVO> departments  = aioveuDepartmentService.getAllDepartmentOptions();

        return Result.success(departments);
    }
```

【WarehouseNameSetter 】新建姓名设置工具类【】

【WarehouseNameSetter调用 】姓名设置工具类调用 【】

```
package com.aioveu.boot.aioveuDepartment.service.impl;

/*
 * @Description: TODO  DepartmentNameSetter
 * @ClassName:  DepartmentNameSetter
 * @Author: 可我不敌可爱
 * @Email: ambitiouschild@qq.com
 * @Date:  2025/8/27  15:17
 * @LastEditors: 可我不敌可爱
 * @LastEditTime: 2025/8/27 15:17
 */

import com.aioveu.boot.aioveuDepartment.service.AioveuDepartmentService;
import com.aioveu.boot.aioveuEmployee.service.impl.EmployeeNameSetter;
import com.aioveu.boot.aioveuPerformance.model.vo.AioveuPerformanceVO;

import java.util.List;
import java.util.Map;
import java.util.Objects;
import java.util.stream.Collectors;
import java.util.function.Function;



public class DepartmentNameSetter {

    /**
     * 批量设置部门姓名到VO对象
     *
     * @param vos VO对象列表
     * @param idGetter 从VO对象获取部门ID的方法
     * @param nameSetter 设置部门姓名到VO对象的方法
     * @param aioveuDepartmentService 部门服务
     * @param <T> VO对象类型
     */
    public static <T> void setDepartmentNames(
            List<T> vos,
            Function<T, Long> idGetter,
            NameSetter<T> nameSetter,
            AioveuDepartmentService aioveuDepartmentService
    ) {
        if (vos == null || vos.isEmpty()) {
            return;
        }

        // 获取所有部门ID
        List<Long> departmentIds = vos.stream()
                .map(idGetter)
                .filter(Objects::nonNull)
                .distinct()
                .collect(Collectors.toList());

        if (departmentIds.isEmpty()) {
            return;
        }

        // 批量查询部门信息
        Map<Long, String> departmentMap = aioveuDepartmentService.getDepartmentMapByIds(departmentIds);

        // 设置员工姓名
        vos.forEach(vo -> {
            Long departmentId = idGetter.apply(vo);
            if (departmentId != null && departmentMap.containsKey(departmentId)) {
                nameSetter.set(vo, departmentMap.get(departmentId));
            } else if (departmentId != null) {
                nameSetter.set(vo, "");
            }
        });

    }

    /**
     * 设置姓名的函数式接口
     *
     * @param <T> VO对象类型
     */
    @FunctionalInterface
    public interface NameSetter<T> {
        void set(T vo, String name);
    }
}

/*
 * @Description: TODO DepartmentNameSetter
 * @ClassName:  DepartmentNameSetter
 * @Param:
 * @Return:
 * @Author: 可我不敌可爱
 * @Email: ambitiouschild@qq.com
 * @Date:  2025-08-27 15:20:31
 * @LastEditors: 可我不敌可爱
 * @LastEditTime: 2025-08-27 15:20:31
 *

    @Autowired
    private AioveuDepartmentService aioveuDepartmentService;

    setDepartmentNames(pageVO.getRecords());


    private void setDepartmentNames(List<AioveuPerformanceVO> performanceVOS) {
        DepartmentNameSetter.setDepartmentNames(
                performanceVOS,
                AioveuPerformanceVO::getDepartmentId, // 获取ID
                AioveuPerformanceVO::setDepartmentName, // 设置姓名
                aioveuDepartmentService
        );
    }

*/

/**
 * 批量设置名称到VO对象，将视图对象的部门id,转换为部门姓名
 */
```

【DepartmentVO + parentDeptName】id -> String【 】

```
vo
	/**
     * 部门名称
     */
    private String deptName;   // 新增：部门名称，用于前端列表显示
    /**
     * 岗位名称
     */
    private String positionName; // 新增：岗位名称，用于前端列表显示
    
        /**
     * 员工姓名
     */
    private String employeeName;
```









### 1.1.2.获取表单数据（Map单键）



```
 // 使用 @Autowired 注入
    @Autowired
    private AioveuDepartmentMapper aioveuDepartmentMapper;


    // 在服务层直接实现，不需要在 Mapper 中添加方法
    //利用了您已经在使用的 MyBatis-Plus 框架，避免了复杂的 XML 配置和 `@MapKey`注解的问题
    @Override
    public Map<String, Long> getDepartmentIdMapByCompositeKeys(List<String> compositeKeys) {
        // 检查输入参数是否为空或空列表
        if (compositeKeys == null || compositeKeys.isEmpty()) {
            return Collections.emptyMap();
        }

        // 初始化结果Map，用于存储复合键到部门ID的映射
        Map<String, Long> resultMap = new HashMap<>();

        // 遍历所有复合键
        for (String compositeKey : compositeKeys) {
            // 使用竖线分隔符拆分复合键
            String[] parts = compositeKey.split("\\|");

            // 确保复合键至少包含两部分（部门名称和父部门ID）
            if (parts.length >= 2) {
                // 第一部分是部门名称
                String deptName = parts[0];
                // 初始化父部门ID为null
                Integer parentDeptId = null;
                // 如果复合键包含第二部分（父部门ID）
                if (parts.length > 1) {
                    try {
                        // 尝试将第二部分转换为整数作为父部门ID
                        parentDeptId = Integer.parseInt(parts[1]);
                    } catch (NumberFormatException e) {
                        // 如果转换失败，跳过当前复合键的处理
                        continue;
                    }
                }

                // 使用 MyBatis-Plus 的 Lambda 查询
                // 查询条件：部门名称等于指定值，如果父部门ID不为空则添加父部门ID条件
                AioveuDepartment department = aioveuDepartmentMapper.selectOne(
                        new QueryWrapper<AioveuDepartment>()
                                .eq("dept_name", deptName) // 部门名称相等条件
                                .eq(parentDeptId != null, "parent_dept_id", parentDeptId) // 条件性添加父部门ID条件
                );

                // 如果查询到对应的部门记录
                if (department != null) {
                    // 将复合键和部门ID添加到结果Map中
                    resultMap.put(compositeKey, department.getDeptId().longValue());
                }
            }
        }

        // 返回包含所有有效映射的结果Map
        return resultMap;
    }
```

```
package com.aioveu.boot.aioveuDepartment.service.impl;

/*
 * @Description: TODO   通过复合键（名称+其他字段）查找对应的ID值
 * @ClassName:  DepartmentIdFinderWithCompositeKey
 * @Author: 可我不敌可爱
 * @Email: ambitiouschild@qq.com
 * @Date:  2025/8/27  17:06
 * @LastEditors: 可我不敌可爱
 * @LastEditTime: 2025/8/27 17:06
 */

import com.aioveu.boot.aioveuDepartment.service.AioveuDepartmentService;
import com.aioveu.boot.aioveuSalesOrder.service.AioveuSalesOrderService;

import java.util.Collections;
import java.util.List;
import java.util.Map;
import java.util.Objects;
import java.util.stream.Collectors;
import java.util.function.Function;


public class DepartmentIdFinderWithCompositeKey {

    /**
     * 通过复合键（名称+其他字段）查找对应的ID值
     *
     * @param form 单个表单对象
     * @param compositeKeyGetter 从VO对象获取复合键的方法
     * @param idSetter 设置订单ID到VO对象的方法
     * @param aioveuDepartmentService 服务
     * @param <T> VO对象类型
     */
    public static <T> void setDepartmentIdsByCompositeKeysform(
            T form,
            Function<T, String> compositeKeyGetter,
            IdSetter<T> idSetter,
            AioveuDepartmentService aioveuDepartmentService
    ) {
        if (form == null) {
            return;
        }

        // 获取复合键
        String compositeKey = compositeKeyGetter.apply(form);
        if (compositeKey == null || compositeKey.trim().isEmpty()) {
            return;
        }


        // 批量查询信息，获取复合键到ID的映射
        List<String> compositeKeys = Collections.singletonList(compositeKey);
        Map<String, Long> compositeKeyToIdMap = aioveuDepartmentService.getDepartmentIdMapByCompositeKeys(compositeKeys);

        // 设置ID
        if (compositeKeyToIdMap.containsKey(compositeKey)) {
            idSetter.set(form, compositeKeyToIdMap.get(compositeKey));
        } else {
            // 处理找不到对应ID的情况
            idSetter.set(form, null);
        }
    }

    /**
     * 通过复合键（名称+其他字段）查找对应的ID值 - 处理对象列表
     *
     * @param forms 表单对象列表
     * @param compositeKeyGetter 从VO对象获取复合键的方法
     * @param idSetter 设置ID到VO对象的方法
     * @param aioveuDepartmentService 服务
     * @param <T> VO对象类型
     */
    public static <T> void setDepartmentIdsByCompositeKeysforms(
            List<T> forms,
            Function<T, String> compositeKeyGetter,
            IdSetter<T> idSetter,
            AioveuDepartmentService aioveuDepartmentService
    ) {
        if (forms == null || forms.isEmpty()) {
            return;
        }

        // 获取所有复合键
        List<String> compositeKeys = forms.stream()
                .map(compositeKeyGetter)
                .filter(Objects::nonNull)
                .filter(key -> !key.trim().isEmpty())
                .distinct()
                .collect(Collectors.toList());

        if (compositeKeys.isEmpty()) {
            return;
        }

        // 批量查询信息，获取复合键到ID的映射
        Map<String, Long> compositeKeyToIdMap = aioveuDepartmentService.getDepartmentIdMapByCompositeKeys(compositeKeys);

        // 设置ID
        forms.forEach(form -> {
            String compositeKey = compositeKeyGetter.apply(form);
            if (compositeKey != null && compositeKeyToIdMap.containsKey(compositeKey)) {
                idSetter.set(form, compositeKeyToIdMap.get(compositeKey));
            } else if (compositeKey != null) {
                // 处理找不到对应ID的情况
                idSetter.set(form, null);
            }
        });
    }

    /**
     * 设置ID的函数式接口
     *
     * @param <T> VO对象类型
     */
    @FunctionalInterface
    public interface IdSetter<T> {
        void set(T vo, Long id);
    }
}
```







### 1.1.3.获取表单数据（Map复合键）

【parentDeptName -> parentDeptId】formData : String -> Id【 】

【SalesOrderIdFinderWithCompositeKey】Map<String, Long>【8.7】

复杂的 XML 配置和 `@MapKey`注解的问题

```
 // 使用 @Autowired 注入
    @Autowired
    private AioveuDepartmentMapper aioveuDepartmentMapper;


    // 在服务层直接实现，不需要在 Mapper 中添加方法
    //利用了您已经在使用的 MyBatis-Plus 框架，避免了复杂的 XML 配置和 `@MapKey`注解的问题
    @Override
    public Map<String, Long> getDepartmentIdMapByCompositeKeys(List<String> compositeKeys) {
        // 检查输入参数是否为空或空列表
        if (compositeKeys == null || compositeKeys.isEmpty()) {
            return Collections.emptyMap();
        }

        // 初始化结果Map，用于存储复合键到部门ID的映射
        Map<String, Long> resultMap = new HashMap<>();

        // 遍历所有复合键
        for (String compositeKey : compositeKeys) {
            // 使用竖线分隔符拆分复合键
            String[] parts = compositeKey.split("\\|");

            // 确保复合键至少包含两部分（部门名称和父部门ID）
            if (parts.length >= 2) {
                // 第一部分是部门名称
                String deptName = parts[0];
                // 初始化父部门ID为null
                Integer parentDeptId = null;
                // 如果复合键包含第二部分（父部门ID）
                if (parts.length > 1) {
                    try {
                        // 尝试将第二部分转换为整数作为父部门ID
                        parentDeptId = Integer.parseInt(parts[1]);
                    } catch (NumberFormatException e) {
                        // 如果转换失败，跳过当前复合键的处理
                        continue;
                    }
                }

                // 使用 MyBatis-Plus 的 Lambda 查询
                // 查询条件：部门名称等于指定值，如果父部门ID不为空则添加父部门ID条件
                AioveuDepartment department = aioveuDepartmentMapper.selectOne(
                        new QueryWrapper<AioveuDepartment>()
                                .eq("dept_name", deptName) // 部门名称相等条件
                                .eq(parentDeptId != null, "parent_dept_id", parentDeptId) // 条件性添加父部门ID条件
                );

                // 如果查询到对应的部门记录
                if (department != null) {
                    // 将复合键和部门ID添加到结果Map中
                    resultMap.put(compositeKey, department.getDeptId().longValue());
                }
            }
        }

        // 返回包含所有有效映射的结果Map
        return resultMap;
    }
```



```
@Override
    public Map<String, Long> getDepartmentIdMapByCompositeKeys(List<String> compositeKeys) {
        if (compositeKeys == null || compositeKeys.isEmpty()) {
            return Collections.emptyMap();
        }

        // 解析复合键
        List<AioveuDepartmentQuery> queries = compositeKeys.stream()
                //Query类，我发现了问题所在。这个类没有接受两个字符串参数的构造函数，只有默认的无参构造函数和setter方法（由Lombok生成）
                .map(key -> {
                    String[] parts = key.split("\\|"); // 假设使用 | 作为分隔符
                    if (parts.length >= 2) {
                        //使用无参构造函数创建Query对象
                        //您需要根据实际的复合键格式调整字段映射（parts[0]、parts[1]等）
                        //如果复合键包含数字字段（如parentDeptId），需要适当转换类型（如Integer.parseInt()）
                        AioveuDepartmentQuery query = new AioveuDepartmentQuery();
                        query.setDeptName(parts[0]); // 假设第一个部分是部门名称
                        // 根据实际情况解析其他字段
                        if (parts.length > 1) {
                            try {
                                query.setParentDeptId(Integer.parseInt(parts[1]));
                            } catch (NumberFormatException e) {
                                // 处理转换异常
                                return null;
                            }
                        }
                        return query;
                    }
                    return null;
                })
                .filter(Objects::nonNull)
                .collect(Collectors.toList());

        // 查询数据库
        List<Map<String, Object>> results = AioveuDepartmentMapper.selectIdByCompositeKeys(queries);

        // 将结果转换为Map
        return results.stream()
                .collect(Collectors.toMap(
                        result -> (String) result.get("name") + "|" + (String) result.get("other_field"),
                        result -> (Long) result.get("id")
                ));
    }

```



```
在 `AioveuDepartmentMapper`接口中添加方法：


// 在 AioveuDepartmentMapper.java 中添加
@Mapper
public interface AioveuDepartmentMapper {
    // 其他方法...
    
    /**
     * 根据复合条件查询部门ID
     * @param queries 查询条件列表
     * @return 包含ID和其他字段的映射列表
     */
    List<Map<String, Object>> selectIdByCompositeKeys(@Param("queries") List<AioveuDepartmentQuery> queries);
}


<!-- 在 AioveuDepartmentMapper.xml 中添加 -->
<select id="selectIdByCompositeKeys" resultType="java.util.HashMap">
    SELECT 
        id,
        dept_name,
        parent_dept_id
    FROM aioveu_department
    WHERE 
    <foreach collection="queries" item="query" open="(" separator=" OR " close=")">
        (dept_name = #{query.deptName} AND parent_dept_id = #{query.parentDeptId})
    </foreach>
</select>

```



```
package com.aioveu.boot.aioveuDepartment.service.impl;

/*
 * @Description: TODO   通过复合键（名称+其他字段）查找对应的ID值
 * @ClassName:  DepartmentIdFinderWithCompositeKey
 * @Author: 可我不敌可爱
 * @Email: ambitiouschild@qq.com
 * @Date:  2025/8/27  17:06
 * @LastEditors: 可我不敌可爱
 * @LastEditTime: 2025/8/27 17:06
 */

import com.aioveu.boot.aioveuDepartment.service.AioveuDepartmentService;
import com.aioveu.boot.aioveuSalesOrder.service.AioveuSalesOrderService;

import java.util.Collections;
import java.util.List;
import java.util.Map;
import java.util.Objects;
import java.util.stream.Collectors;
import java.util.function.Function;


public class DepartmentIdFinderWithCompositeKey {

    /**
     * 通过复合键（名称+其他字段）查找对应的ID值
     *
     * @param form 单个表单对象
     * @param compositeKeyGetter 从VO对象获取复合键的方法
     * @param idSetter 设置订单ID到VO对象的方法
     * @param aioveuDepartmentService 服务
     * @param <T> VO对象类型
     */
    public static <T> void setDepartmentIdsByCompositeKeysform(
            T form,
            Function<T, String> compositeKeyGetter,
            IdSetter<T> idSetter,
            AioveuDepartmentService aioveuDepartmentService
    ) {
        if (form == null) {
            return;
        }

        // 获取复合键
        String compositeKey = compositeKeyGetter.apply(form);
        if (compositeKey == null || compositeKey.trim().isEmpty()) {
            return;
        }


        // 批量查询信息，获取复合键到ID的映射
        List<String> compositeKeys = Collections.singletonList(compositeKey);
        Map<String, Long> compositeKeyToIdMap = aioveuDepartmentService.getDepartmentIdMapByCompositeKeys(compositeKeys);

        // 设置ID
        if (compositeKeyToIdMap.containsKey(compositeKey)) {
            idSetter.set(form, compositeKeyToIdMap.get(compositeKey));
        } else {
            // 处理找不到对应ID的情况
            idSetter.set(form, null);
        }
    }

    /**
     * 通过复合键（名称+其他字段）查找对应的ID值 - 处理对象列表
     *
     * @param forms 表单对象列表
     * @param compositeKeyGetter 从VO对象获取复合键的方法
     * @param idSetter 设置ID到VO对象的方法
     * @param aioveuDepartmentService 服务
     * @param <T> VO对象类型
     */
    public static <T> void setDepartmentIdsByCompositeKeysforms(
            List<T> forms,
            Function<T, String> compositeKeyGetter,
            IdSetter<T> idSetter,
            AioveuDepartmentService aioveuDepartmentService
    ) {
        if (forms == null || forms.isEmpty()) {
            return;
        }

        // 获取所有复合键
        List<String> compositeKeys = forms.stream()
                .map(compositeKeyGetter)
                .filter(Objects::nonNull)
                .filter(key -> !key.trim().isEmpty())
                .distinct()
                .collect(Collectors.toList());

        if (compositeKeys.isEmpty()) {
            return;
        }

        // 批量查询信息，获取复合键到ID的映射
        Map<String, Long> compositeKeyToIdMap = aioveuDepartmentService.getDepartmentIdMapByCompositeKeys(compositeKeys);

        // 设置ID
        forms.forEach(form -> {
            String compositeKey = compositeKeyGetter.apply(form);
            if (compositeKey != null && compositeKeyToIdMap.containsKey(compositeKey)) {
                idSetter.set(form, compositeKeyToIdMap.get(compositeKey));
            } else if (compositeKey != null) {
                // 处理找不到对应ID的情况
                idSetter.set(form, null);
            }
        });
    }

    /**
     * 设置ID的函数式接口
     *
     * @param <T> VO对象类型
     */
    @FunctionalInterface
    public interface IdSetter<T> {
        void set(T vo, Long id);
    }
}

```







## 1.2.单次查询

### 1.2.1.获取表单数据（entity to Form）



【AioveuDepartmentForm】entity to Form : Id  -> String 【 】

```
form
     /**
     * 部门名称
     */
    private String deptName;   // 新增：部门名称，用于前端表单显示
    /**
     * 岗位名称
     */
    private String positionName; // 新增：部门名称，用于前端表单显示
    
        /**
     * 员工姓名
     */
    private String employeeName;
    
        /**
     * 部门名称
     */
    private String deptName;   
```



```
//DeptOptionVO-----------------------------------------------------------------------------

@Getter
@Setter
@Schema( description = "公司部门选项")
public class DeptOptionVO {

    private Long deptId;
    /**
     * 部门名称
     */
    private String deptName;
    /**
     * 带参数的构造函数
     *
     * @param deptId 部门ID
     * @param deptName 部门名称
     */
    public DeptOptionVO(Long deptId, String deptName) {
        this.deptId = deptId;
        this.deptName = deptName;
    }

}

//PositionOptionVO-----------------------------------------------------------------------------    
    /**
     * 带参数的构造函数
     *
     * @param positionId 部门ID
     * @param positionName 部门名称
     */
    public PositionOptionVO(Long positionId, String positionName) {
        this.positionId = positionId;
        this.positionName = positionName;
    }
```



员工表单

```
aioveuEmployeeService.getById转换为aioveuEmployeeService.getOne(Wrapper);
```

```
    /**
     * 获取员工信息表单数据
     *
     * @param id 员工信息ID
     * @return 员工信息表单数据
     */
    @Override
    public AioveuEmployeeForm getAioveuEmployeeFormData(Long id) {
        // 1. 根据ID获取实体信息
        AioveuEmployee entity = this.getById(id);
        if (entity == null) {
            throw new ServiceException("不存在");
        }
        // 2. 将实体转换为表单对象
        AioveuEmployeeForm form = aioveuEmployeeConverter.toForm(entity);

        // 3. 处理映射信息（如果存在）
        if (entity.getDeptId() != null) {
                        // 使用 MyBatis-Plus 的 LambdaQueryWrapper 查询信息
                        // 创建一个 LambdaQueryWrapper 对象，用于构建查询条件
                        // 泛型 <AioveuDepartment> 指定了查询的实体类型
            LambdaQueryWrapper<AioveuDepartment> Wrapper = new LambdaQueryWrapper<>();
                        // 添加查询条件：部门ID等于指定值
                        // AioveuDepartment::getDeptId 是方法引用，表示查询 dept_id 字段
                        // entity.getDeptId() 是获取要查询的具体部门ID值
            Wrapper.eq(AioveuDepartment::getDeptId, entity.getDeptId())
                        // 指定只选择 dept_name 字段，而不是所有字段
                        // 这是一个性能优化，减少不必要的数据传输
                    .select(AioveuDepartment::getDeptName); // 只选择需要的字段

            AioveuDepartment department = aioveuDepartmentService.getOne(Wrapper);

            if (department != null) {
                form.setDeptName(department.getDeptName());
            }
        }

        if (entity.getPositionId() != null) {
                        // 使用 MyBatis-Plus 的 LambdaQueryWrapper 查询信息
                        // 创建一个 LambdaQueryWrapper 对象，用于构建查询条件
                        // 泛型 <AioveuPosition> 指定了查询的实体类型
            LambdaQueryWrapper<AioveuPosition> Wrapper = new LambdaQueryWrapper<>();
                        // 添加查询条件：岗位ID等于指定值
                        // AioveuPosition::getPositionId 是方法引用，表示查询 position_id 字段
                        // entity.getPositionId() 是获取要查询的具体岗位ID值
            Wrapper.eq(AioveuPosition::getPositionId, entity.getPositionId())
                        // 指定只选择 position_name 字段，而不是所有字段
                        // 这是一个性能优化，减少不必要的数据传输
                    .select(AioveuPosition::getPositionName); // 只选择需要的字段

            AioveuPosition position = aioveuPositionService.getOne(Wrapper);

            if (position != null) {
                form.setPositionName(position.getPositionName());
            }
        }


//        // 设置部门名称
//        if (entity.getDeptId() != null) {
//            AioveuDepartment department = aioveuDepartmentService.getById(entity.getDeptId());
//            if (department != null) {
//                form.setPositionName(department.getDeptName());
//            }
//        }
//
//        // 设置岗位名称
//        if (entity.getPositionId() != null) {
//            AioveuPosition position = aioveuPositionService.getById(entity.getPositionId());
//            if (position != null) {
//                form.setPositionName(position.getPositionName());
//            }
//        }

        return form;
    }
```



部门表单

```
    public AioveuDepartmentForm getAioveuDepartmentFormData(Long id) {
            // 1. 根据ID获取实体信息
            AioveuDepartment entity = this.getById(id);
            if (entity == null) {
                throw new ServiceException("不存在");
            }

            // 2. 将实体转换为表单对象
            AioveuDepartmentForm form = aioveuDepartmentConverter.toForm(entity);

            // 3. 处理映射信息（如果存在）
            if (entity.getParentDeptId() != null) {
                                // 使用 MyBatis-Plus 的 LambdaQueryWrapper 查询父部门信息
                                // 创建一个 LambdaQueryWrapper 对象，用于构建查询条件
                                // 泛型 <AioveuDepartment> 指定了查询的实体类型
                    LambdaQueryWrapper<AioveuDepartment> Wrapper = new LambdaQueryWrapper<>();
                                // 添加查询条件：部门ID等于指定值
                                // AioveuDepartment::getDeptId 是方法引用，表示查询 dept_id 字段
                                // entity.getParentDeptId() 是获取要查询的具体部门ID值
                    Wrapper.eq(AioveuDepartment::getDeptId, entity.getParentDeptId())
                                        // 指定只选择 dept_name 字段，而不是所有字段
                                        // 这是一个性能优化，减少不必要的数据传输
                            .select(AioveuDepartment::getDeptName); // 只选择需要的字段

                    AioveuDepartment parentDepartment = this.getOne(Wrapper);
                    //AioveuDepartment department = aioveuDepartmentService.getOne(Wrapper);

                    if (parentDepartment != null) {
                    form.setParentDeptName(parentDepartment.getDeptName());
                    }
             }

        return form;
    }
```



```
1.​LambdaQueryWrapper<AioveuDepartment>​
    •这是 MyBatis-Plus 提供的查询条件构建器
    •使用泛型指定要查询的实体类型（这里是 AioveuDepartment）
    •支持 Lambda 表达式，提供类型安全的查询条件构建
2.​.eq(AioveuDepartment::getDeptId, entity.getParentDeptId())​
    •eq方法表示"等于"条件
    •AioveuDepartment::getDeptId是方法引用，相当于指定数据库中的 dept_id字段
    •entity.getParentDeptId()是获取要匹配的具体值
    •整体意思是：WHERE dept_id = entity.getParentDeptId()
3.​.select(AioveuDepartment::getDeptName)​
    •select方法用于指定查询的字段
    •AioveuDepartment::getDeptName是方法引用，表示只查询 dept_name字段
    •这是一个重要的性能优化，避免了查询所有字段（SELECT *）
    •只返回需要的字段，减少网络传输和数据处理开销
```



### 1.2.2.新增数据（单个查询）

【saveAioveuEmployee】新增数据【 】

#### 字段验证单次使用

```
    /**
     * 新增员工信息
     *
     * @param formData 员工信息表单对象
     * @return 是否新增成功
     */
    @Override
    public boolean saveAioveuEmployee(AioveuEmployeeForm formData) {
        // 字段1：检查员工编号是否唯一（对于不依赖外键的字段，不可重复）
        LambdaQueryWrapper<AioveuEmployee> queryWrapper = new LambdaQueryWrapper<>();
        queryWrapper.eq(AioveuEmployee::getEmpCode, formData.getEmpCode());
        if (count(queryWrapper) > 0) {
            throw new RuntimeException("员工编号: " + formData.getEmpCode() + " 已存在");
        }

        // 字段2：检查是否已存在相同名称的记录（对于不依赖外键的字段，不可重复）
        queryWrapper.eq(AioveuEmployee::getName, formData.getName());
        if (count(queryWrapper) > 0) {
            throw new RuntimeException("姓名: "+ formData.getName() +"已存在");
        }

        // 字段3：检查员工编号是否唯一（对于不依赖外键的字段，不可重复）
        queryWrapper.eq(AioveuEmployee::getIdCard, formData.getIdCard());
        if (count(queryWrapper) > 0) {
            throw new RuntimeException("身份证号: " + formData.getIdCard() + " 已存在");
        }

        // 字段4：检查是否存在记录（对于必须依赖外键的字段,必须存在，可重复） //在相关字段加注解  @NotNull(message = "不存在")
        LambdaQueryWrapper<AioveuDepartment> depWrapper = new LambdaQueryWrapper<>();
        depWrapper.eq(AioveuDepartment::getDeptName, formData.getDeptName());

        AioveuDepartment department = aioveuDepartmentService.getOne(depWrapper);
        if (department != null) {
            formData.setDeptId(department.getDeptId());
        } else {
            throw new RuntimeException("部门: " + formData.getDeptName() + " 不存在");
        }

        // 字段5：检查是否存在记录（对于必须依赖外键的字段,必须存在，可重复） //在相关字段加注解  @NotNull(message = "不存在")
        LambdaQueryWrapper<AioveuPosition> positionWrapper = new LambdaQueryWrapper<>();
        positionWrapper.eq(AioveuPosition::getPositionName, formData.getPositionName());

        AioveuPosition position = aioveuPositionService.getOne(positionWrapper);
        if (position != null) {
            formData.setPositionId(position.getPositionId());
        } else {
            throw new RuntimeException("岗位： " + formData.getPositionName() + " 不存在");
        }


        // 2. 将表单数据转换为实体对象
        AioveuEmployee entity = aioveuEmployeeConverter.toEntity(formData);

        // 3. 执行插入
        return this.save(entity);
    }
```

#### 字段验证器抽取复用

```
仓库姓名验证器抽取
```

```
package com.aioveu.boot.aioveuWarehouse.service.impl;

/*
 * @Description: TODO  仓库姓名验证器
 * @ClassName:  WarehouseNameValidator
 * @Author: 可我不敌可爱
 * @Email: ambitiouschild@qq.com
 * @Date:  2025/8/30  4:49
 * @LastEditors: 可我不敌可爱
 * @LastEditTime: 2025/8/30 4:49
 */

//构造函数命名错误：构造函数名必须与类名完全一致（包括大小写） public employeeName

// 之前（构造函数）
//public EmployeeNameValidator(...) {...}

// 之后（静态方法）
//public static <T> void validateAndSetEmployeeId(...) {...}

import com.baomidou.mybatisplus.core.conditions.query.LambdaQueryWrapper;
import com.baomidou.mybatisplus.core.toolkit.support.SFunction;
import com.baomidou.mybatisplus.extension.service.IService;

import java.util.function.Function;
import java.util.function.ToLongFunction;


public class NameValidator {


    /**
     * 验证实体存在并设置ID
     *
     * @param <T> 表单数据类型
     * @param <E> 实体类型
     * @param formData 表单数据对象
     * @param nameGetter 获取名称的函数
     * @param fieldGetter 实体字段的getter方法
     * @param idSetter 设置ID的函数
     * @param entityService 实体服务
     * @param entityName 实体名称（用于错误消息）
     */

    //构造函数命名错误：构造函数名必须与类名完全一致（包括大小写） public employeeName

    // 之前（构造函数）
    //public EmployeeNameValidator(...) {...}

    // 之后（静态方法）
    //public static <T> void validateAndSetEmployeeId(...) {...}

    public static <T, E> void validateEntityUnique(
            T formData,
            Function<T, String> nameGetter, // 使用 Function
            SFunction<E, String> fieldGetter,
            Function<T, Long> idSetter,
            IService<E> entityService,  // 使用通用服务
            String entityName
    ) {
        // 字段1：检查编号是否唯一（对于不依赖外键的字段，不可重复）
        LambdaQueryWrapper<E> wrapper = new LambdaQueryWrapper<>();
        // 正确调用：传递 formData 参数
        wrapper.eq(fieldGetter, nameGetter.apply(formData));

        if (entityService.count(wrapper) > 0) {
            throw new RuntimeException( entityName + nameGetter.apply(formData) + " 已存在");
        }
    }

    /**
     * 验证实体存在并设置ID
     *
     * @param <T> 表单数据类型
     * @param <E> 实体类型
     * @param formData 表单数据对象
     * @param nameGetter 获取名称的函数
     * @param fieldGetter 实体字段的getter方法
     * @param idSetter 设置ID的函数
     * @param entityService 实体服务
     * @param entityName 实体名称（用于错误消息）
     */
    public  static <T, E> void  validateEntityExists(
            T formData,
            Function<T, String> nameGetter, // 使用 Function
            SFunction<E, String> fieldGetter,
            IdSetter<T> idSetter,
            ToLongFunction<E> idExtractor, // 新增：从实体E中提取ID
            IService<E> entityService,  // 使用通用服务
            String entityName
    ) {
        // 字段1：检查是否存在记录（对于必须依赖外键的字段,必须存在，可重复） //在相关字段加注解  @NotNull(message = "不存在")
        LambdaQueryWrapper<E> wrapper = new LambdaQueryWrapper<>();
        // 正确调用：传递 formData 参数
        wrapper.eq(fieldGetter, nameGetter.apply(formData));

        E entity = entityService.getOne(wrapper);
        if (entity != null) {
            idSetter.set(formData,idExtractor.applyAsLong(entity));
        } else {
            throw new RuntimeException( entityName + nameGetter.apply(formData) + " 不存在");
        }
    }

    /**
     * 设置ID的函数式接口
     *
     * @param <T> VO对象类型
     */
    @FunctionalInterface
    public interface IdSetter<T> {
        void set(T formData, Long id);
    }

}

/*
 * @Description: TODO  仓库姓名验证器
 * @ClassName:  EmployeeNameValidator
 * @Param:
 * @Return:
 * @Author: 可我不敌可爱
 * @Email: ambitiouschild@qq.com
 * @Date:  2025-08-30 03:18:20
 * @LastEditors: 可我不敌可爱
 * @LastEditTime: 2025-08-30 03:18:20
 *
 *

        // 字段1：检查编号是否唯一（对于不依赖外键的字段，不可重复）
        NameValidator.validateEntityUnique(
                formData,
                AioveuWarehouseForm::getName,
                AioveuWarehouse::getName,
                null,
                this,
                "仓库"
        );


        // 字段3：检查是否存在记录（对于必须依赖外键的字段,必须存在，可重复） //在相关字段加注解  @NotNull(message = "不存在"
        NameValidator.validateEntityExists(
            formData,
            AioveuWarehouseForm::getWarehouseName,
            AioveuWarehouse::getName,
            AioveuWarehouseForm::setManagerId,
            AioveuWarehouse::getId, 
            aioveuWarehouseService,
            "仓库"
        );

*/

```



员工引用

```
        // 字段3：检查是否存在记录（对于必须依赖外键的字段,必须存在，可重复） //在相关字段加注解  @NotNull(message = "不存在"
        EmployeeNameValidator.validateEntityExists(
                formData,
                AioveuWarehouseForm::getManagerName,  // 获取经理姓名的方法
                AioveuEmployee::getName,  // 实体字段：员工姓名
//                (form, id) -> form.setManagerId(id), // 设置经理ID的方法  // 使用显式Lambda（推荐）
                AioveuWarehouseForm::setManagerId, // 直接使用方法引用
                AioveuEmployee::getEmployeeId, // 从员工实体获取ID的方法
                aioveuEmployeeService,  // 员工服务（不是this）
                "经理"  // 实体名称（用于错误消息）
        );
```







前端新增按钮打开弹窗

```
      dialog.title = "新增公司部门组织结构";
      // 新增操作直接打开弹窗
      dialog.visible = true;
```



### 1.2.3.更新数据（单个查询）



```
【updateAioveuEmployee】更新数据
```

#### 表单对象字段更新抽取复用

```
EntityUpdateHandler.handleUpdate(
            id,
            formData,
            entity -> this.updateById(entity),
            this::getById,
            this::convertToEntity,
            (entity, entityId) -> entity.setDeptId(entityId)
        );
```

#### 表单对象字段更新单次使用

注意：表单对象通常不包含ID，因此需要手动设置ID,这是与新建的最大区别，保留原始数据的未更新字段

复用可以节省代码量，但会增加查询次数，所以要Map多次查询加复用代码

```
@Override
public boolean updateAioveuDepartment(Long id, AioveuDepartmentForm formData) {
    log.info("开始更新部门: ID={}", id);

    // 1. 获取原始部门信息 - 使用单个查询
    AioveuDepartment original = getById(id);
    if (original == null) {
        log.error("部门不存在: ID={}", id);
        throw new ServiceException("部门不存在");
    }

    // 2. 处理父部门关系：根据父部门名称查询父部门ID - 使用单个查询
    if (formData.getParentDeptName() != null && !formData.getParentDeptName().trim().isEmpty()) {
        // 构建查询条件：根据父部门名称精确匹配
        LambdaQueryWrapper<AioveuDepartment> parentQueryWrapper = new LambdaQueryWrapper<>();
        parentQueryWrapper.eq(AioveuDepartment::getDeptName, formData.getParentDeptName());
        
        // 执行单个查询获取父部门信息
        AioveuDepartment parentDepartment = this.getOne(parentQueryWrapper);
        
        if (parentDepartment != null) {
            // 设置父部门ID到表单数据中
            formData.setParentDeptId(parentDepartment.getDeptId());
            log.info("找到父部门: ID={}, 名称={}", parentDepartment.getDeptId(), formData.getParentDeptName());
        } else {
            // 处理父部门不存在的情况
            formData.setParentDeptId(null);
            log.warn("未找到父部门: 名称={}", formData.getParentDeptName());
            // 根据业务需求，可以选择抛出异常或保留null值
            // throw new ServiceException("父部门名称不存在: " + formData.getParentDeptName());
        }
    } else {
        // 如果父部门名称为空，确保父部门ID也为空
        formData.setParentDeptId(null);
    }



只判断外键，因为主键新增的时候已经判断
//------------------------------------------------------------------------------------
    // 3. 将表单数据转换为实体对象
    // 注意：表单对象通常不包含ID，因此需要手动设置ID,这是与新建的最大区别，保留原始数据的未更新字段
    AioveuDepartment entity = aioveuDepartmentConverter.toEntity(formData);
    entity.setDeptId(id); // 设置部门ID
    log.info("转换后的实体对象: {}", entity);

    // 4. 保留原始创建时间（不应在更新时修改）
    entity.setCreateTime(original.getCreateTime());
    
    // 5. 设置更新时间（通常更新操作需要记录更新时间）
    //entity.setUpdateTime(new Date());

//-----------------------------------------------------------------------------------
    // 6. 执行更新操作 - 使用单个更新查询
    boolean result = this.updateById(entity);
    log.info("更新结果: {}", result);
    
    return result;
}
```





### 1.2.4.删除数据



## 1.3.MapStruct 转换器配置

确保转换器接口使用 `@Mapping(target = "deptName", ignore = true)`注解，避免 MapStruct 尝试自动映射 `deptName`字段。部门名称应在 Service 层手动设置。

 MapStruct 自动映射的是form

```


    /**
     * 实体转VO - 忽略deptName字段，在Service层手动设置
     */
    @Mapping(target = "deptName", ignore = true)
    AioveuPositionVO toVO(AioveuPosition entity);

    /**
     * 实体列表转VO列表 - 忽略deptName字段
     */
    List<AioveuPositionVO> toVO(List<AioveuPosition> entities);
```

```
   /**
     * 实体转VO - 忽略deptName字段，在Service层手动设置
     */
    @Override
    public AioveuPositionVO toVO(AioveuPosition entity) {
        if ( entity == null ) {
            return null;
        }

        AioveuPositionVO aioveuPositionVO = new AioveuPositionVO();

        aioveuPositionVO.setPositionId( entity.getPositionId() );
        aioveuPositionVO.setPositionName( entity.getPositionName() );
        aioveuPositionVO.setDeptId( entity.getDeptId() );
        aioveuPositionVO.setPositionLevel( entity.getPositionLevel() );
        aioveuPositionVO.setDescription( entity.getDescription() );
        aioveuPositionVO.setCreateTime( entity.getCreateTime() );
        aioveuPositionVO.setUpdateTime( entity.getUpdateTime() );

        return aioveuPositionVO;
    }


    /**
     * 实体列表转VO列表 - 忽略deptName字段
     */
    @Override
    public List<AioveuPositionVO> toVO(List<AioveuPosition> entities) {
        if ( entities == null ) {
            return null;
        }

        List<AioveuPositionVO> list = new ArrayList<AioveuPositionVO>( entities.size() );
        for ( AioveuPosition aioveuPosition : entities ) {
            list.add( toVO( aioveuPosition ) );
        }

        return list;
    }
```



## 1.4.后端表单增加id字段或者自定义字段 （新增会自动创建不需要展示id）

后端form

```

    @Schema(description = "会员等级ID")
    private Long id;

```

后端转换器

```
toForm
 
aioveuMemberLevelForm.setId( entity.getId() );
        
toEntity

aioveuMemberLevel.setId( formData.getId() );
```

由于MapStruct的映射策略或缓存机制（重要重要）

```
预防措施
​定期清理构建​：在修改实体类或表单类后，执行mvn clean install或gradle clean build


1. 清除并重新构建项目
MapStruct在编译时生成代码，如果新添加字段后没有重新编译，生成的代码可能不包含新字段。

mvn clean install
2. 检查字段命名
确保实体类和表单类中的字段名称一致（包括大小写）。MapStruct默认按名称匹配。

3. 显式添加字段映射
在转换器接口中，使用@Mapping注解显式指定新字段的映射关系。

@Mapper(componentModel = "spring")
public interface AioveuMemberConverter {

    @Mapping(target = "newField", source = "newField") // 添加这行
    AioveuMemberForm toForm(AioveuMember entity);

    @Mapping(target = "newField", source = "newField") // 添加这行
    AioveuMember toEntity(AioveuMemberForm formData);
}
```





前端api增加字段

```
    /** 会员ID */
    id?:  number;
```

前端views增加字段

```
表单无需显示，因为新增不需要，但是保留字段可以避免后端赋值，前端也无需创建编辑id,这样提交表单，id直接存在
代码生成时还是选择表单，手动隐藏掉表单项即可



  /** 提交会员等级表单 */
  function handleSubmit() {
    dataFormRef.value.validate((valid: any) => {
      if (valid) {
        loading.value = true;
        // const id = editingId.value;
        const id = formData.id;
//----------------------------------------------------------------------------------------------------------

添加图标提示

<el-form-item label="会员ID" prop="id">
  <el-input
    v-model="formData.id"
    placeholder="会员ID"
    disabled
  >
    <template #prefix>
      <el-icon><lock /></el-icon>
    </template>
  </el-input>
</el-form-item>
```



## 1.5.后端列表增加自定义字段

后端vo

```
    
    @Schema(description = "会员等级ID")
    private Long id;
    
```

前端api增加字段

```
    /** 自定义字段 */
    id?:  number;
```

前端views增加字段

```

```



# 2.前端



## 2.1.前端查询









1. 1.

   前端通过下拉框选择，此时前端已经通过选项接口获取了所有选项（OptionVO列表），用户选择后，表单中提交的是value（ID）。

2. 2.

   前端通过自由输入文本，然后我们需要通过映射服务将文本转换成ID。

下面，我们分别设计这两个部分：

一、提供选项列表的接口（返回OptionVO列表）

二、提供将字符串映射到ID的接口（即之前的映射服务）



```
查询关联表
        <!-- 修改：将所属部门ID改为所属部门名称 -->
                <el-form-item label="所属部门" prop="deptId">
                    <el-select
                      v-model="queryParams.deptId"
                      placeholder="请选择部门"
                      clearable
                      filterable
                    >
                      <!-- 遍历部门选项列表 -->
                      <!-- 使用部门ID作为唯一键，确保高效渲染 -->
                      <!-- 显示部门名称作为选项标签 -->
                      <!-- 使用部门ID作为选项值 -->
                      <el-option
                        v-for="dept in deptOptions"
                        :key="dept.deptId"
                        :label="dept.deptName"
                        :value="dept.deptId"
                      />
                    </el-select>
                </el-form-item>
      
      查询字典值
                <el-form-item label="状态" prop="status">
                      <el-select
                          v-model="queryParams.status"
                          placeholder="状态"
                          clearable
                          filterable
                          @keyup.enter="handleQuery()"
                      >
                          <el-option
                          v-for="item in statusOptions"
                          :key="Number(item.value)"
                          :label="item.label"
                          :value="Number(item.value)"
                          />
                    </el-select>
                </el-form-item>
```



## 2.2.前端列表



绑定正确的数据源：

•在表格中使用scope.row.status

```
<!--  <template #default="scope">：使用Vue的插槽(slot)来自定义列的内容 -->
<!-- #default：这是Element UI表格列的默认插槽，用于自定义单元格显示内容-->
<!-- scope：是一个对象，包含当前行的数据（scope.row）和其他表格信息-->
<!--  DictLabel： likely是一个自定义组件，用于根据字典代码和值显示对应的标签文本 -->
<!-- v-model="scope.row.status"：双向绑定当前行数据中的status字段值（可能是数字或代码值）-->
```



```
        <el-table-column
          label="考核季度"
          min-width="150"
          align="center"
        >
          <template #default="scope">
            <DictLabel v-model="scope.row.periodQuarter" code="performance_period_quarter" />
          </template>
        </el-table-column>
```





## 2.3.前端表单



```
【AioveuEmployeeForm】新增deptName，positionName
```

表单展示（后端映射字段）：根据后端查找（展示）

```
                <el-form-item label="员工" prop="employeeName">
                      <el-input
                          v-model="formData.employeeName"
                          placeholder="员工"
                      />
                </el-form-item>
```

表单展示（后端映射字段）：根据列表字段选项（展示 + 可修改）



```
type="textarea"

                <el-form-item label="权益描述" prop="benefits">
                      <el-input
                          v-model="formData.benefits"
                          placeholder="权益描述"
                          type="textarea"
                      />
                </el-form-item>
```

```
        <!-- 修改：将所属部门ID改为所属部门名称 -->
                <el-form-item label="所属部门" prop="deptId">
                    <el-select
                      v-model="formData.deptId"
                      placeholder="请选择部门"
                      clearable
                      filterable
                    >
                      <el-option
                        v-for="dept in deptOptions"
                        :key="dept.deptId"
                        :label="dept.deptName"
                        :value="dept.deptId"
                      />
                    </el-select>
                </el-form-item>
```



表单展示（后端映射字典）：根据字典选项（展示 + 可修改）

```
3.1表单修改
```

表单展示（后端映射字典）：根据字典选项（展示 + 不可修改）**无法使用，必须导入字典**

    绑定正确的数据源​：•在表单中使用formData.status
    
    			<el-form-item label="性别" prop="gender">
                          <dict v-model="formData.gender" code="gender" />
                </el-form-item>



```
                <el-form-item label="状态" prop="status">
                  <el-select
                    v-model="formData.status"
                    placeholder="状态"
                    clearable
                  >
                    <el-option
                      v-for="item in statusOptions"
                      :key="Number(item.value)"
                      :label="item.label"
                      :value="Number(item.value)"
                    />
                  </el-select>
                </el-form-item>
```

### //先准备数据，再显示弹窗

```
   //const editingId = ref<number | undefined>(undefined);
 
 
 /** 打开公司岗位信息弹窗 */
  function handleOpenDialog(id?: number) {

    //editingId.value = id; // 保存ID

    if (id) {
      dialog.title = "修改公司岗位信息";
            AioveuPositionAPI.getFormData(id).then((data) => {
        Object.assign(formData, data);
              //先准备数据，再显示弹窗
              dialog.visible = true;
      });
    } else {
      dialog.title = "新增公司岗位信息";
            dialog.title = "新增公司部门组织结构";
            // 新增操作直接打开弹窗
            dialog.visible = true;
    }
  }
```



使用响应式框架的特性（Vue 示例）

```
        try {
          const { data } = await AioveuPositionAPI.getFormData(positionId);
          
          // 使用Vue的$set或直接赋值（如果使用Vue 3的reactive）
          Object.keys(this.formData).forEach(key => {
            this.$set(this.formData, key, data[key] !== undefined ? data[key] : null);
          });
          
        } catch (error) {
          console.error("加载数据失败", error);
        } finally {
          this.dialog.loading = false;
        }
      } else {
        this.dialog.title = "新增公司岗位信息";
        
        // 清空表单
        Object.keys(this.formData).forEach(key => {
          this.$set(this.formData, key, null);
        });
        
        this.dialog.loading = false;
      }
```

### // 延迟重置表单（等待动画完成）

```
  /** 关闭员工工资明细弹窗 */
  function handleCloseDialog() {
    dialog.visible = false;
    // 关键修复：在关闭弹窗时重置加载状态
    loading.value = false;

    // 延迟重置表单（等待动画完成）
    setTimeout(() => {
    dataFormRef.value.resetFields();
    dataFormRef.value.clearValidate();
    //editingId.value = undefined;
    formData.id = undefined;
    }, 300);

  }
```





我们首先需要明确：在表格中，`scope.row`代表当前行的数据对象。`scope.row.id`就是当前行数据对象的 `id`属性值。这个 `id`应该对应数据库中的主键ID。

### `scope.row.id`的来源

1. **`scope.row`是什么？**
   - 在 Element Plus 的表格组件中，`scope.row`表示**当前行的数据对象**
   - 这个对象来自于您绑定的 `pageData`数组中的元素
2. **`id`属性的来源：**
   - 这个 `id`属性来自您的 API 返回的数据结构
   - 具体来说，来自 `AioveuMemberAPI.getPage()`返回的 `data.list`中的对象
3. **数据库关系：**
   - 这个 `id`应该对应数据库表中的主键 ID
   - 在您的 `aioveu_member`表中，`id`是主键列



### //前端表单需要带ID，然后前端隐藏

前端处理：

1. **修改表单时携带主键**：在编辑表单时，前端需要将主键（通常是ID）作为表单数据的一部分（通常是隐藏字段）或者通过URL参数（如RESTful风格的`/resource/:id`）传递给后端。
2. **主键不可编辑**：主键字段不应该在表单中显示给用户编辑，通常使用隐藏的输入字段（`<input type="hidden">`）或者从编辑页面的路由参数中获取。

后端处理：

1. **验证主键的合法性**：后端接收到主键后，需要验证该主键对应的记录是否存在，以及当前用户是否有权限修改该记录。
2. **防止主键被篡改**：虽然主键由前端传递，但后端不应该完全信任前端传递的数据。必须进行严格的权限校验，确保用户只能修改自己有权修改的数据。



```
                <el-form-item label="会员等级ID" prop="id">
                      <el-input
                          type="hidden"
                          v-model="formData.id"
                          placeholder="会员等级ID"

                      />
                </el-form-item>
                
   将会员等级ID字段设置为可见但不可编辑状态，使用禁用状态（disabled）比隐藏字段更透明
   
<el-form-item label="会员等级ID" prop="id">
  <!-- 使用 disabled 属性使输入框不可编辑 -->
  <el-input
    v-model="formData.id"
    placeholder="会员等级ID"
    disabled
  />
</el-form-item>

使用只读输入框
<el-form-item label="会员等级ID" prop="id">
  <!-- 使用只读输入框 -->
  <el-input
    v-model="formData.id"
    placeholder="会员等级ID"
    readonly
  />
</el-form-item>


添加图标提示

<el-form-item label="会员等级ID" prop="id">
  <el-input
    v-model="formData.id"
    placeholder="会员等级ID"
    disabled
  >
    <template #prefix>
      <el-icon><lock /></el-icon>
    </template>
  </el-input>
</el-form-item>

设计考虑
​用户体验​：
使用禁用状态（disabled）比隐藏字段更透明
添加锁图标直观表示字段不可编辑
浅灰色背景提示用户这是只读内容

​安全性​：

主键值仍然包含在表单数据中
后端需要验证用户是否有权修改该ID对应的记录
防止用户尝试修改主键值

​表单验证​：

即使字段不可编辑，仍然可以参与表单验证
确保提交时包含必要的主键信息
这种设计既保持了表单的完整性，又清晰地展示了哪些字段是只读的，同时确保后端能够正确识别要修改的记录。
```



## 2.4.前端选项



```
//---------------------------------------------------------------------------
        <!-- 修改：将所属部门ID改为所属部门名称 -->
                <el-form-item label="所属部门" prop="deptId">
                      <el-select
                        v-model="formData.deptId"
                        placeholder="请选择部门"
                        clearable
                        filterable
                      >
                        <el-option
                          v-for="dept in deptOptions"
                          :key="dept.deptId"
                          :label="dept.deptName"
                          :value="dept.deptId"
                        />
                      </el-select>
                </el-form-item>
                
                
                  <!-- 修改：将所属部门ID改为所属部门名称 -->
                <el-form-item label="所属部门" prop="deptId">
                    <el-select
                      v-model="formData.deptId"
                      placeholder="请选择部门"
                      clearable
                      filterable
                    >
                      <el-option
                        v-for="dept in deptOptions"
                        :key="dept.deptId"
                        :label="dept.deptName"
                        :value="dept.deptId"
                      />
                    </el-select>
                </el-form-item>   
```

选项

```
                <el-form-item label="父分类" prop="parentCategoryName">
                  <el-select
                    v-model="formData.parentCategoryName"
                    placeholder="请选择父分类"
                    clearable
                    filterable
                  >
                    <el-option
                      v-for="category in parentCategoryOptions"
                      :key="category.categoryId"
                      :label="category.categoryName"
                      :value="category.categoryName"
                    />
                  </el-select>
                </el-form-item>
```





## 2.5.前端API



```
    getDepartmentMapByIds(deptIds: number[]) {
      return request<Map<number, string>>({
        url: `${AIOVEUDEPARTMENT_BASE_URL}/map`,
        method: "post",
        data: deptIds
      });
    },


    /**
     * 获取所有部门列表（用于下拉选择框）
     * @returns 部门选项列表
     * 因为request函数的类型定义允许第一个类型参数为any，从而绕过了类型检查
     */
    getAllDepartmentOptions() {
      return request<any,DeptOptionVO[]>({
        url: `${AIOVEUDEPARTMENT_BASE_URL}/options`,
        method: "get",
      });
    }
    
    
    
    /** 部门选项VO（用于下拉选择框） */
export interface DeptOptionVO {
  /** 部门ID */
  deptId: number;
  /** 部门名称 */
  deptName: string;
}
```



## 2.6.前端方法



```
 接口
   // 新增：导入部门API
  import AioveuDepartmentAPI, { DeptOptionVO } from "@/api/aioveuDepartment/aioveu-department";
  
    import AioveuCategoryAPI, {CategoryOptionVO} from "@/api/aioveuCategory/aioveu-category";
  
    // 新增：部门选项  
  const deptOptions = ref<DeptOptionVO[]>([]);
  
    // 新增：父分类选项
  const parentCategoryOptions = ref<CategoryOptionVO[]>([]);
  
  
  // 主要修改点：部门列表加载方法
  function loadDepartments() {
    loading.value = true;
    AioveuDepartmentAPI.getAllDepartmentOptions()
      
      .then(response => {
        // 确保响应数据是数组类型
        if (Array.isArray(response)) {
          // 转换数据类型：确保deptId是数字
          deptOptions.value = response.map(dept => ({
            deptId: Number(dept.deptId),
            deptName: dept.deptName
          }));
        } else {
          // 处理非数组响应
          console.error("部门列表响应格式错误:", response);
          ElMessage.error("部门列表格式错误");
        }
      })
      .catch(error => {
        console.error("加载部门列表失败:", error);
        ElMessage.error("加载部门列表失败");
      })
      .finally(() => {
        loading.value = false;
      });
  }
  
    onMounted(() => {
    handleQuery();
    //在 onMounted钩子中调用了 loadDepartments()函数,确保函数被正确使用
    loadDepartments();
  });
```

方法



```
  // 加载选项
  function loadParentCategoryOptions() {
    AioveuCategoryAPI.getAllCategoryOptions().then(response => {
      parentCategoryOptions.value = response
    })
  }
  
  
      onMounted(() => {
    handleQuery();
    //在 onMounted钩子中调用了 loadDepartments()函数,确保函数被正确使用
    loadParentCategoryOptions();
  });
```







// 延迟重置表单（等待动画完成）

```
  /** 关闭员工工资明细弹窗 */
  function handleCloseDialog() {
    dialog.visible = false;
    // 关键修复：在关闭弹窗时重置加载状态
    loading.value = false;

    // 延迟重置表单（等待动画完成）
    setTimeout(() => {
    dataFormRef.value.resetFields();
    dataFormRef.value.clearValidate();
    editingSalaryId.value = undefined;
    }, 300);

  }
```





# 3.字典值



## 3.1表单修改（根据字典值选项）

【根据字典值选项】1.使用getDictItemsAPI从后端获取字典值，字典名称AttendanceStatus对应考勤状态字典【3.0】

1.字典值加载：
•使用getDictItemsAPI从后端获取字典值
•字典名称AttendanceStatus对应考勤状态字典
2.下拉选择器：
•使用el-select组件替代DictLabel
•绑定v-model="queryParams.status"保持数据同步
•使用el-option遍历字典值生成选项

表单展示（后端映射字典）：根据字典选项（展示 + 可修改）

```
解决下拉选项显示问题
formData字段值类型为number
字典值类型为varchar
```

解决下拉选项显示问题

```
                <el-form-item label="考核季度" prop="periodQuarter">
                  <el-select
                    v-model="formData.periodQuarter"
                    placeholder="考核季度"
                    clearable
                  >
                    <el-option
                      v-for="item in periodQuarterOptions"
                      :key="Number(item.value)"
                      :label="item.label"
                      :value="Number(item.value)"
                    />
                  </el-select>
                </el-form-item>
```

表单展示（后端映射字典）：根据字典选项（展示 + 可修改）



```
<script setup lang="ts">
    // 导入字典值
  import DictAPI,{ DictItemOption } from '@/api/system/dict.api'
  
  // 选项
  const periodQuarterOptions = ref<DictItemOption[]>([])
  
  // 加载字典
  function loadPeriodQuarterOptions() {
    DictAPI.getDictItems('performance_period_quarter').then(response => {
      periodQuarterOptions.value = response
    })
  }
  
  onMounted(() => {
        loadPeriodQuarterOptions();
    // 其他初始化代码...
  })
```



## 3.2查询修改（后端映射字典）

根据字典选项（展示 + 可修改）

```
        <el-form-item label="考勤状态" prop="status">
              <el-select
                v-model="queryParams.status"
                placeholder="请选择考勤状态"
                clearable
              >
                <el-option 
                  v-for="item in attendanceStatusOptions" 
                  :key="item.value" 
                  :label="item.label" 
                  :value="item.value"
                />
              </el-select>
         </el-form-item>
```

方法

```
<script setup lang="ts">
    // 导入字典值
  import DictAPI,{ DictItemOption } from '@/api/system/dict.api'
  
  // 状态选项
  const attendanceStatusOptions = ref<DictItemOption[]>([])
  
   // 状态字典
  function loadAttendanceStatus() {
    DictAPI.getDictItems('AttendanceStatus').then(response => {
      attendanceStatusOptions.value = response
    })
  }
  
  onMounted(() => {
    loadAttendanceStatus()
    // 其他初始化代码...
  })
```



## 3.3字典值

| 字典名称         | 字典编码                   | 字典项                                                       |
| ---------------- | -------------------------- | ------------------------------------------------------------ |
| 性别             | gender                     |                                                              |
| 员工状态         | employee_status            | 员工状态：0-离职，1-在职,2-休假,3-实习                       |
| 考勤状态         | attendance_status          | 考勤状态：0-正常，1-迟到，2-早退，3-缺勤，4-休假             |
| 职级(1-10)       | position_level             | 职级(1-10，数字越大职级越高)                                 |
| 考核季度(1-4)    | performance_period_quarter | 考核季度(1-4)  第 1 季度                                     |
| 绩效等级         | performance_grade          | A b c d                                                      |
| 工资发放状态     | salary_payment_status      | 发放状态：0-未发放，1-已发放，2-发放失败                     |
| 物资启用状态     | material_is_active         | 启用状态：0-禁用，1-启用                                     |
| 仓库启用状态     | warehouse_is_active        | 启用状态：0-停用，1-启用                                     |
| 入库类型         | inbound_type               | 入库类型：1-采购入库，2-退货入库，3-调拨入库，4-其他         |
| 设备状态         | equipment_status           | 状态：1-在用，2-闲置，3-维修中，4-报废                       |
| 采购状态         | procurement_status         | 状态：1-待审核，2-已下单，3-已发货，4-已收货，5-已入库，6-已取消 |
| 出库状态         | outbound_status            | 状态：1-待出库，2-已出库，3-已取                             |
| 客户类型         | customer_customer_type     | 客户类型：1-企业，2-个人，3-政府，4-其他                     |
| 信用等级         | customer_credit_rating     | 信用等级：1-AAA，2-AA，3-A，4-B，5-C                         |
| 客户状态         | customer_status            | 客户状态：1-潜在客户，2-活跃客户，3-休眠客户，4-流失客户     |
| 客户来源         | customer_source            | 客户来源：1-线上推广，2-线下活动，3-客户推荐，4-销售开发，5-其他 |
| 是否是主要联系人 | contact_is_primary         | 是否是主要联系人：0-否，1-是                                 |
| 交易支付方式     | transaction_payment_method | 支付方式：1-现金，2-银行转账，3-信用卡，4-支付宝，5-微信支付，6-其他 |
| 交易支付状态     | transaction_payment_status | 支付状态：1-待支付，2-部分支付，3-已支付，4-已退款           |
| 交易类型         | transaction_type           | 交易类型：1-销售，2-服务，3-退款，4-其他                     |
| 交易状态         | transaction_status         | 交易状态：1-进行中，2-已完成，3-已取                         |
| 订单付款条件     | salesOrder_payment_terms   | 付款条件：1-预付全款，2-货到付款，3-月结30天，4-月结60天，5-其他 |
| 订单支付状态     | salesOrder_payment_status  | 支付状态：1-未支付，2-部分支付，3-已支付                     |
| 订单状态         | salesOrder_order_status    | 订单状态：1-待处理，2-已确认，3-生产中，4-已发货，5-已完成，6-已取消 |
| 订单运输方式     | salesOrder_shipping_method | 运输方式：1-快递，2-物流，3-自提，4-其他                     |
| 订单明细状态     | salesOrderDetail_status    | 明细状态：1-待处理，2-备货中，3-已发货，4-已收货，5-已取消   |

会员管理

| 字典名称             | 字典编码                            | 字典项                                                       |
| -------------------- | ----------------------------------- | ------------------------------------------------------------ |
| 会员等级状态         | member_level_status                 | 会员等级状态(0-禁用 1-启用)                                  |
| 会员状态             | member_status                       | 会员状态(0-禁用 1-正常)                                      |
| 会员充值账户状态     | member_account_status               | 会员充值账户状态(0-冻结 1-正常)                              |
| 会员充值记录支付方式 | member_recharge_record_payment_type | 会员充值记录支付方式 1-wechat-微信,2-alipay-支付宝,3-cash-现金,4-card-信用卡,5-bank-银行 |
| 会员充值记录充值状态 | member_recharge_record_status       | 会员充值记录充值状态1-pending待定,2-success成功,3-failed失败 |

洗衣业务

| 字典名称                 | 字典编码                          | 字典项                                                       |      |
| ------------------------ | --------------------------------- | ------------------------------------------------------------ | ---- |
| 洗衣订单状态             | laundry_order_status              | 洗衣订单状态 0创建,1接收,2洗衣,3干燥,4熨烫,5质量检查,6完成,7运送,8取消 |      |
| 洗衣订单支付状态         | laundry_order_payment_status      | 洗衣订单支付状态 1-未支付-unpaid,2-部分支付-partial,3-已支付-paid,4-退还-refunded |      |
| 衣物类别                 | laundry_clothing_type_category    | 衣物类别,0-上装-top,1-下装-bottom,2-外套-outerwear,3-内衣-underwear,4-配饰-accessories,5-家居用品-home,6-特殊衣物-special |      |
| 衣物是否精细             | laundry_clothing_type_is_delicate | 是否精细衣物:0-非精细衣物,1-精细衣物                         |      |
| 衣物类别状态             | laundry_clothing_type_status      | 衣物类别状态(0-停用 1-启用)                                  |      |
| 洗衣订单衣物明细处理状态 | laundry_order_item_process_status | 洗衣订单衣物明细处理状态 1-待处理-pending,2-洗涤中-washing,3-烘干中-drying,4-熨烫中-ironing,5-质检中-quality_check,6-已完成-finished,7-问题衣物-problem |      |
| 洗衣流程图片记录图片类型 | laundry_process_image_image_type  | 图片类型 1-收衣时-receive,2-洗涤中-washing,3-烘干中-drying,4-熨烫中-ironing,5-完成时-finish,6-问题衣物-problem,7-质检时-quality_check,8-交付时-delivery |      |
|                          |                                   |                                                              |      |
|                          |                                   |                                                              |      |









# 4.查询

## 4.1.后端查询



1. 修改查询对象

```
@Schema(description = "员工查询对象")
@Getter
@Setter
public class AioveuEmployeeQuery extends BasePageQuery {
    
    // 原有字段...
    
    @Schema(description = "部门名称")
    private String deptName;
    
    @Schema(description = "岗位名称")
    private String positionName;
    
    // 添加转换后的ID字段
    private Long deptId;
    private Long positionId;
}
```

2. 在服务层实现名称到ID的转换

```
import cn.idev.excel.util.StringUtils;


@Service
public class AioveuEmployeeServiceImpl implements AioveuEmployeeService {
    
    @Autowired
    private AioveuDepartmentService departmentService;
    
    @Autowired
    private AioveuPositionService positionService;
    
    @Override
    public IPage<AioveuEmployeeVO> getAioveuEmployeePage(AioveuEmployeeQuery queryParams) {
        // 处理部门名称映射
        if (StringUtils.isNotBlank(queryParams.getDeptName())) {
            Long deptId = departmentService.getIdByName(queryParams.getDeptName());
            queryParams.setDeptId(deptId);
        }
        
        // 处理岗位名称映射
        if (StringUtils.isNotBlank(queryParams.getPositionName())) {
            Long positionId = positionService.getIdByName(queryParams.getPositionName());
            queryParams.setPositionId(positionId);
        }
        
        // 执行分页查询
        Page<AioveuEmployeeVO> pageVO = this.baseMapper.getAioveuEmployeePage(
            new Page<>(queryParams.getPageNum(), queryParams.getPageSize()),
            queryParams
        );
        
        // 设置部门名称
        setDeptNames(pageVO.getRecords());
        
        // 设置岗位名称
        setPositionNames(pageVO.getRecords());
        
        return pageVO;
    }
}
```



// 处理上级部门名称映射

```
        // 处理上级部门名称映射
        if (StringUtils.isNotBlank(queryParams.getParentDeptName())) {
            Long parentDeptId = this.getIdByName(queryParams.getParentDeptName());
            queryParams.setParentDeptId(parentDeptId);
        }
```



3. 实现名称到ID的映射服务

```
@Service
public class AioveuDepartmentServiceImpl implements AioveuDepartmentService {
    
    @Autowired
    private AioveuDepartmentMapper departmentMapper;
    
    @Override
    public Long getIdByName(String name) {
        return departmentMapper.findIdByName(name);
    }
}
```



4. 在Mapper中添加查询方法

```
@Mapper
public interface AioveuDepartmentMapper extends BaseMapper<AioveuDepartment> {
    
    @Select("SELECT id FROM aioveu_department WHERE name = #{name}")
    Long findIdByName(@Param("name") String name);
}
```

5. 修改Mapper XML

```
<select id="getAioveuEmployeePage" resultType="com.aioveu.boot.aioveuEmployee.model.vo.AioveuEmployeeVO">
    SELECT
        e.employee_id,
        e.name,
        e.gender,
        e.email,
        e.phone,
        e.position_id,
        e.dept_id,
        e.status,
        e.create_time,
        e.update_time
    FROM
        aioveu_employee e
    <where>
        <!-- 原有条件 -->
        
        <!-- 部门ID查询 -->
        <if test="queryParams.deptId != null">
            AND e.dept_id = #{queryParams.deptId}
        </if>
        
        <!-- 岗位ID查询 -->
        <if test="queryParams.positionId != null">
            AND e.position_id = #{queryParams.positionId}
        </if>
    </where>
    ORDER BY e.employee_id DESC
</select>
```



## 4.2.前端查询

查询

```
【AioveuDepartmentPageQuery】搜索优化【9.3】
```

```
                <el-form-item label="状态" prop="status">
                  <el-select
                    v-model="queryParams.status"
                    placeholder="状态"
                    clearable
                    filterable
                    @keyup.enter="handleQuery()"
                  >
                    <el-option
                      v-for="item in statusOptions"
                      :key="Number(item.value)"
                      :label="item.label"
                      :value="Number(item.value)"
                    />
                  </el-select>
                </el-form-item>
```

```
  不能回车快捷查询，框也太长
  
  <el-form-item label="性别" prop="gender">
                          <dict v-model="queryParams.gender" code="gender" />
                </el-form-item>
```

```
  绩效等级实体类queryParams.performanceGrade保存的是字符串 ， 绩效等级字典值保存的也是字符串
               
               <el-form-item label="绩效等级" prop="performanceGrade">
                  <el-select
                    v-model="queryParams.performanceGrade"
                    placeholder="绩效等级"
                    clearable
                    filterable
                    @keyup.enter="handleQuery()"
                  >
                    <el-option
                      v-for="item in performanceGradeOptions"
                      :key="item.value"
                      :label="item.label"
                      :value="item.value"
                    />
                  </el-select>
                </el-form-item>
```







方法

```
<script setup lang="ts">
    // 导入字典值
  import DictAPI,{ DictItemOption } from '@/api/system/dict.api'
  
  // 选项
  const periodQuarterOptions = ref<DictItemOption[]>([])
  
  // 加载字典
  function loadPeriodQuarterOptions() {
    DictAPI.getDictItems('performance_period_quarter').then(response => {
      periodQuarterOptions.value = response
    })
  }
  
  onMounted(() => {
        loadPeriodQuarterOptions();
    // 其他初始化代码...
  })
```

# 5.让前端表单最新数据显示在最前面

## 1. 后端排序实现（推荐）



只需要让最新数据显示在最前面，不需要复杂的排序选择功能

```
后端修改（关键一步）

 // 创建分页对象，并强制添加创建时间降序排序（最新在前）
    Page<AioveuEmployeeVO> page = new Page<>(queryParams.getPageNum(), queryParams.getPageSize());
    page.addOrder(OrderItem.desc("create_time")); // 添加这一行即可
    
    // 执行分页查询
    Page<AioveuEmployeeVO> pageVO = this.baseMapper.getAioveuEmployeePage(page, queryParams);
    
    // 添加日志验证
log.info("查询结果数量: {}, 第一条记录的创建时间: {}", 
         pageVO.getRecords().size(),
         pageVO.getRecords().get(0).getCreateTime());
    
```

前端不需要任何修改

您的所有表单页面都会自动将最新创建的数据显示在最前面，不需要前端做任何改动。

```
这会在 SQL 查询中添加 ORDER BY create_time DESC，确保最新创建的数据排在前面
```



### 如果数据库没有 create_time 字段

若您没有 `create_time`字段，可以使用替代方案：

```
// 使用主键降序（假设id是自增主键）
page.addOrder(OrderItem.desc("id"));

// 或使用更新时间降序
page.addOrder(OrderItem.desc("update_time"));
```

### 保证性能

在数据库中对 `create_time`字段添加索引：

```
-- MySQL
ALTER TABLE aioveu_employee ADD INDEX idx_create_time (create_time);

-- PostgreSQL
CREATE INDEX idx_employee_create_time ON aioveu_employee (create_time DESC);
```

## 完全不需要前端改动的方案

如果您希望所有查询都默认最新在前，只需这一次后端修改，前端无需任何变动。

如果您需要在前端展示排序状态，只需增加一个标识：





# 6.菜单目录整理



## 6.1人员管理模块



| 父级菜单 | 菜单名称 | 菜单类型 | 路由名称           | 路由路径           | 组件路径                                   |
| -------- | :------- | -------- | ------------------ | ------------------ | ------------------------------------------ |
|          | 人员管理 | 目录     |                    | /aioveUser         |                                            |
| 1        | 部门管理 | 菜单     | aioveu_department  | aioveu_department  | aioveuDepartment/aioveu-department/index   |
| 2        | 岗位管理 | 菜单     | aioveu_position    | aioveu_position    | aioveuPosition/aioveu-position/index       |
| 3        | 员工管理 | 菜单     | aioveu_employee    | aioveu_employee    | aioveuEmployee/aioveu-employee/index       |
| 4        | 考勤管理 | 菜单     | aioveu_attendance  | aioveu_attendance  | aioveuAttendance/aioveu-attendance/index   |
| 5        | 绩效管理 | 菜单     | aioveu_performance | aioveu_performance | aioveuPerformance/aioveu-performance/index |
| 6        | 薪资管理 | 菜单     | aioveu_salary      | aioveu_salary      | aioveuSalary/aioveu-salary/index           |
|          |          |          |                    |                    |                                            |
|          |          |          |                    |                    |                                            |

按钮1

| 父级菜单 | 菜单名称 | 菜单类型 | 排序 | 权限标识                                  |      |
| -------- | -------- | -------- | ---- | ----------------------------------------- | ---- |
| 部门管理 | 部门查询 | 按钮     | 1    | aioveuDepartment:aioveu-department:query  |      |
|          | 部门新增 | 按钮     | 2    | aioveuDepartment:aioveu-department:add    |      |
|          | 部门编辑 | 按钮     | 3    | aioveuDepartment:aioveu-department:edit   |      |
|          | 部门删除 | 按钮     | 4    | aioveuDepartment:aioveu-department:delete |      |

2

| 父级菜单 | 菜单名称 | 菜单类型 | 排序 | 权限标识                              |      |
| -------- | -------- | -------- | ---- | ------------------------------------- | ---- |
| 岗位管理 | 岗位查询 | 按钮     | 1    | aioveuPosition:aioveu-position:query  |      |
|          | 岗位新增 | 按钮     | 2    | aioveuPosition:aioveu-position:add    |      |
|          | 岗位编辑 | 按钮     | 3    | aioveuPosition:aioveu-position:edit   |      |
|          | 岗位删除 | 按钮     | 4    | aioveuPosition:aioveu-position:delete |      |

3

| 父级菜单 | 菜单名称 | 菜单类型 | 排序 | 权限标识                              |      |
| -------- | -------- | -------- | ---- | ------------------------------------- | ---- |
| 员工管理 | 员工查询 | 按钮     | 1    | aioveuEmployee:aioveu-employee:query  |      |
|          | 员工新增 | 按钮     | 2    | aioveuEmployee:aioveu-employee:add    |      |
|          | 员工编辑 | 按钮     | 3    | aioveuEmployee:aioveu-employee:edit   |      |
|          | 员工删除 | 按钮     | 4    | aioveuEmployee:aioveu-employee:delete |      |

4

| 父级菜单 | 菜单名称 | 菜单类型 | 排序 | 权限标识                                  |      |
| -------- | -------- | -------- | ---- | ----------------------------------------- | ---- |
| 考勤管理 | 考勤查询 | 按钮     | 1    | aioveuAttendance:aioveu-attendance:query  |      |
|          | 考勤新增 | 按钮     | 2    | aioveuAttendance:aioveu-attendance:add    |      |
|          | 考勤编辑 | 按钮     | 3    | aioveuAttendance:aioveu-attendance:edit   |      |
|          | 考勤删除 | 按钮     | 4    | aioveuAttendance:aioveu-attendance:delete |      |

5

| 父级菜单 | 菜单名称 | 菜单类型 | 排序 | 权限标识                                    |      |
| -------- | -------- | -------- | ---- | ------------------------------------------- | ---- |
| 绩效管理 | 绩效查询 | 按钮     | 1    | aioveuPerformance:aioveu-performance:query  |      |
|          | 绩效新增 | 按钮     | 2    | aioveuPerformance:aioveu-performance:add    |      |
|          | 绩效编辑 | 按钮     | 3    | aioveuPerformance:aioveu-performance:edit   |      |
|          | 绩效删除 | 按钮     | 4    | aioveuPerformance:aioveu-performance:delete |      |



6

| 父级菜单 | 菜单名称 | 菜单类型 | 排序 | 权限标识                          |      |
| -------- | -------- | -------- | ---- | --------------------------------- | ---- |
| 薪资管理 | 薪资查询 | 按钮     | 1    | aioveuSalary:aioveu-salary:query  |      |
|          | 薪资新增 | 按钮     | 2    | aioveuSalary:aioveu-salary:add    |      |
|          | 薪资编辑 | 按钮     | 3    | aioveuSalary:aioveu-salary:edit   |      |
|          | 薪资删除 | 按钮     | 4    | aioveuSalary:aioveu-salary:delete |      |





## 6.2物资管理模块





| 父级菜单 | 菜单名称     | 菜单类型 | 路由名称           | 路由路径           | 组件路径                               |
| -------- | :----------- | -------- | ------------------ | ------------------ | -------------------------------------- |
|          | 物资管理     | 目录     |                    | /aioveuMaterial    |                                        |
| 1        | 物资分类管理 | 菜单     | aioveu_category    | aioveu_category    | aioveuCategory/aioveu-category/index   |
| 2        | 物资管理     | 菜单     | aioveu_material    | aioveu_material    | aioveuMaterial/aioveu-material/index   |
| 3        | 仓库管理     | 菜单     | aioveu_warehouse   | aioveu_warehouse   | aioveuWarehouse/aioveu-warehouse/index |
| 4        | 库存管理     | 菜单     | aioveu_inventory   | aioveu_inventory   | aioveuInventory/aioveu-inventory/index |
| 5        | 入库管理     | 菜单     | aioveu_inbound     | aioveu_inbound     | aioveuInbound/aioveu-inbound/index     |
| 6        | 设备管理     | 菜单     | aioveu_equipment   | aioveu_equipment   | aioveuEquipment/aioveu-equipment/index |
| 7        | 采购管理     | 菜单     | aioveu_procurement | aioveu_procurement | aioveu/aioveu-procurement/index        |
| 8        | 出库管理     | 菜单     | aioveu_outbound    | aioveu_outbound    | aioveuOutbound/aioveu-outbound/index   |



| 父级菜单     | 菜单名称     | 菜单类型 | 排序 | 权限标识                              |      |
| ------------ | ------------ | -------- | ---- | ------------------------------------- | ---- |
| 物资分类管理 | 物资分类查询 | 按钮     | 1    | aioveuCategory:aioveu-category:query  |      |
|              | 物资分类新增 | 按钮     | 2    | aioveuCategory:aioveu-category:add    |      |
|              | 物资分类编辑 | 按钮     | 3    | aioveuCategory:aioveu-category:edit   |      |
|              | 物资分类删除 | 按钮     | 4    | aioveuCategory:aioveu-category:delete |      |



| 父级菜单 | 菜单名称 | 菜单类型 | 排序 | 权限标识                              |      |
| -------- | -------- | -------- | ---- | ------------------------------------- | ---- |
| 物资管理 | 物资查询 | 按钮     | 1    | aioveuMaterial:aioveu-material:query  |      |
|          | 物资新增 | 按钮     | 2    | aioveuMaterial:aioveu-material:add    |      |
|          | 物资编辑 | 按钮     | 3    | aioveuMaterial:aioveu-material:edit   |      |
|          | 物资删除 | 按钮     | 4    | aioveuMaterial:aioveu-material:delete |      |



| 父级菜单 | 菜单名称 | 菜单类型 | 排序 | 权限标识                                |      |
| -------- | -------- | -------- | ---- | --------------------------------------- | ---- |
| 仓库管理 | 仓库查询 | 按钮     | 1    | aioveuWarehouse:aioveu-warehouse:query  |      |
|          | 仓库新增 | 按钮     | 2    | aioveuWarehouse:aioveu-warehouse:add    |      |
|          | 仓库编辑 | 按钮     | 3    | aioveuWarehouse:aioveu-warehouse:edit   |      |
|          | 仓库删除 | 按钮     | 4    | aioveuWarehouse:aioveu-warehouse:delete |      |



| 父级菜单 | 菜单名称 | 菜单类型 | 排序 | 权限标识                                |      |
| -------- | -------- | -------- | ---- | --------------------------------------- | ---- |
| 库存管理 | 库存查询 | 按钮     | 1    | aioveuInventory:aioveu-inventory:query  |      |
|          | 库存新增 | 按钮     | 2    | aioveuInventory:aioveu-inventory:add    |      |
|          | 库存编辑 | 按钮     | 3    | aioveuInventory:aioveu-inventory:edit   |      |
|          | 库存删除 | 按钮     | 4    | aioveuInventory:aioveu-inventory:delete |      |



| 父级菜单 | 菜单名称 | 菜单类型 | 排序 | 权限标识                            |      |
| -------- | -------- | -------- | ---- | ----------------------------------- | ---- |
| 入库管理 | 入库查询 | 按钮     | 1    | aioveuInbound:aioveu-inbound:query  |      |
|          | 入库新增 | 按钮     | 2    | aioveuInbound:aioveu-inbound:add    |      |
|          | 入库编辑 | 按钮     | 3    | aioveuInbound:aioveu-inbound:edit   |      |
|          | 入库删除 | 按钮     | 4    | aioveuInbound:aioveu-inbound:delete |      |



| 父级菜单 | 菜单名称 | 菜单类型 | 排序 | 权限标识                                |      |
| -------- | -------- | -------- | ---- | --------------------------------------- | ---- |
| 设备管理 | 设备查询 | 按钮     | 1    | aioveuEquipment:aioveu-equipment:query  |      |
|          | 设备新增 | 按钮     | 2    | aioveuEquipment:aioveu-equipment:add    |      |
|          | 设备编辑 | 按钮     | 3    | aioveuEquipment:aioveu-equipment:edit   |      |
|          | 设备删除 | 按钮     | 4    | aioveuEquipment:aioveu-equipment:delete |      |





| 父级菜单 | 菜单名称 | 菜单类型 | 排序 | 权限标识                         |      |
| -------- | -------- | -------- | ---- | -------------------------------- | ---- |
| 采购管理 | 采购查询 | 按钮     | 1    | aioveu:aioveu-procurement:query  |      |
|          | 采购新增 | 按钮     | 2    | aioveu:aioveu-procurement:add    |      |
|          | 采购编辑 | 按钮     | 3    | aioveu:aioveu-procurement:edit   |      |
|          | 采购删除 | 按钮     | 4    | aioveu:aioveu-procurement:delete |      |



| 父级菜单 | 菜单名称 | 菜单类型 | 排序 | 权限标识                              |      |
| -------- | -------- | -------- | ---- | ------------------------------------- | ---- |
| 出库管理 | 出库查询 | 按钮     | 1    | aioveuOutbound:aioveu-outbound:query  |      |
|          | 出库新增 | 按钮     | 2    | aioveuOutbound:aioveu-outbound:add    |      |
|          | 出库编辑 | 按钮     | 3    | aioveuOutbound:aioveu-outbound:edit   |      |
|          | 出库删除 | 按钮     | 4    | aioveuOutbound:aioveu-outbound:delete |      |



## 6.4客户管理模块









| 父级菜单 | 菜单名称     | 菜单类型 | 路由名称                  | 路由路径                  | 组件路径                                               |
| -------- | :----------- | -------- | ------------------------- | ------------------------- | ------------------------------------------------------ |
|          | 客户管理     | 目录     |                           | /aioveuMember             |                                                        |
| 1        | 客户管理     | 菜单     | aioveu_customer           | aioveu_customer           | aioveuCustomer/aioveu-customer/index                   |
| 2        | 联系人管理   | 菜单     | aioveu_contact            | aioveu_contact            | aioveuContact/aioveu-contact/index                     |
| 3        | 交易管理     | 菜单     | aioveu_transaction        | aioveu_transaction        | aioveuTransaction/aioveu-transaction/index             |
| 4        | 订单管理     | 菜单     | aioveu_sales_order        | aioveu_sales_order        | aioveuSalesOrder/aioveu-sales-order/index              |
| 5        | 订单明细管理 | 菜单     | aioveu_sales_order_detail | aioveu_sales_order_detail | aioveuSalesOrderDetail/aioveu-sales-order-detail/index |





| 父级菜单 | 菜单名称 | 菜单类型 | 排序 | 权限标识                              |      |
| -------- | -------- | -------- | ---- | ------------------------------------- | ---- |
| 客户管理 | 客户查询 | 按钮     | 1    | aioveuCustomer:aioveu-customer:query  |      |
|          | 客户新增 | 按钮     | 2    | aioveuCustomer:aioveu-customer:add    |      |
|          | 客户编辑 | 按钮     | 3    | aioveuCustomer:aioveu-customer:edit   |      |
|          | 客户删除 | 按钮     | 4    | aioveuCustomer:aioveu-customer:delete |      |





| 父级菜单   | 菜单名称   | 菜单类型 | 排序 | 权限标识                            |      |
| ---------- | ---------- | -------- | ---- | ----------------------------------- | ---- |
| 联系人管理 | 联系人查询 | 按钮     | 1    | aioveuContact:aioveu-contact:query  |      |
|            | 联系人新增 | 按钮     | 2    | aioveuContact:aioveu-contact:add    |      |
|            | 联系人编辑 | 按钮     | 3    | aioveuContact:aioveu-contact:edit   |      |
|            | 联系人删除 | 按钮     | 4    | aioveuContact:aioveu-contact:delete |      |





| 父级菜单 | 菜单名称 | 菜单类型 | 排序 | 权限标识                                    |      |
| -------- | -------- | -------- | ---- | ------------------------------------------- | ---- |
| 交易管理 | 交易查询 | 按钮     | 1    | aioveuTransaction:aioveu-transaction:query  |      |
|          | 交易新增 | 按钮     | 2    | aioveuTransaction:aioveu-transaction:add    |      |
|          | 交易编辑 | 按钮     | 3    | aioveuTransaction:aioveu-transaction:edit   |      |
|          | 交易删除 | 按钮     | 4    | aioveuTransaction:aioveu-transaction:delete |      |





| 父级菜单 | 菜单名称 | 菜单类型 | 排序 | 权限标识                                   |      |
| -------- | -------- | -------- | ---- | ------------------------------------------ | ---- |
| 订单管理 | 订单查询 | 按钮     | 1    | aioveuSalesOrder:aioveu-sales-order:query  |      |
|          | 订单新增 | 按钮     | 2    | aioveuSalesOrder:aioveu-sales-order:add    |      |
|          | 订单编辑 | 按钮     | 3    | aioveuSalesOrder:aioveu-sales-order:edit   |      |
|          | 订单删除 | 按钮     | 4    | aioveuSalesOrder:aioveu-sales-order:delete |      |





| 父级菜单     | 菜单名称     | 菜单类型 | 排序 | 权限标识                                                |      |
| ------------ | ------------ | -------- | ---- | ------------------------------------------------------- | ---- |
| 订单明细管理 | 订单明细查询 | 按钮     | 1    | aioveuSalesOrderDetail:aioveu-sales-order-detail:query  |      |
|              | 订单明细新增 | 按钮     | 2    | aioveuSalesOrderDetail:aioveu-sales-order-detail:add    |      |
|              | 订单明细编辑 | 按钮     | 3    | aioveuSalesOrderDetail:aioveu-sales-order-detail:edit   |      |
|              | 订单明细删除 | 按钮     | 4    | aioveuSalesOrderDetail:aioveu-sales-order-detail:delete |      |



## 6.5.独立会员系统设计（与客户解耦）



| 父级菜单     | 菜单名称     | 菜单类型 | 排序 | 权限标识                                     |      |
| ------------ | ------------ | -------- | ---- | -------------------------------------------- | ---- |
| 会员等级管理 | 会员等级查询 | 按钮     | 1    | aioveuMemberLevel:aioveu-member-level:query  |      |
|              | 会员等级新增 | 按钮     | 2    | aioveuMemberLevel:aioveu-member-level:add    |      |
|              | 会员等级编辑 | 按钮     | 3    | aioveuMemberLevel:aioveu-member-level:edit   |      |
|              | 会员等级删除 | 按钮     | 3    | aioveuMemberLevel:aioveu-member-level:delete |      |

























# 7.获取物资列表

```

                <el-form-item label="物资" prop="materialName">
                      <el-select
                        v-model="queryParams.materialName"
                        placeholder="物资"
                        clearable
                        filterable
                      >
                        <el-option
                          v-for="material in materialOptions"
                          :key="material.materialId"
                          :label="material.materialName"
                          :value="material.materialName"
                        />
                      </el-select>
                </el-form-item>
                
                
                <el-form-item label="物资" prop="materialName">
                    <el-select
                      v-model="formData.materialName"
                      placeholder="物资"
                      clearable
                      filterable
                    >
                      <el-option
                        v-for="material in materialOptions"
                        :key="material.materialId"
                        :label="material.materialName"
                        :value="material.materialName"
                      />
                    </el-select>
                </el-form-item> 
```

前端API

```
    /**
     * 获取所有部门列表（用于下拉选择框）
     * @returns 部门选项列表
     * 因为request函数的类型定义允许第一个类型参数为any，从而绕过了类型检查
     */
    getAllMaterialOptions() {
      return request<any,MaterialOptionVO[]>({
        url: `${AIOVEUMATERIAL_BASE_URL}/options`,
        method: "get",
      });
    }
    
    
    
export interface MaterialOptionVO {
  materialId: number;
  materialName: string;
}
```





前端方法

```
 接口
  import AioveuMaterialAPI, { MaterialOptionVO } from "@/api/aioveuMaterial/aioveu-material";
  
  
  const materialOptions = ref<MaterialOptionVO[]>([]);
  
  
  
    // 加载选项
  function loadMaterialOptions() {
    AioveuMaterialAPI.getAllMaterialOptions().then(response => {
      materialOptions.value = response
    })
  }
  
  
      onMounted(() => {
    handleQuery();
    //在 onMounted钩子中调用了 loadDepartments()函数,确保函数被正确使用
    loadMaterialOptions();
  });
```



# 8.获取仓库列表

```

                <el-form-item label="仓库" prop="warehouseName">
                      <el-select
                        v-model="queryParams.warehouseName"
                        placeholder="仓库"
                        clearable
                        filterable
                        @keyup.enter="handleQuery()"
                      >
                        <el-option
                          v-for="warehouse in warehouseOptions"
                          :key="warehouse.warehouseId"
                          :label="warehouse.warehouseName"
                          :value="warehouse.warehouseName"
                        />
                      </el-select>
                </el-form-item>
               
                
                  <el-form-item label="仓库" prop="warehouseName">
                      <el-select
                        v-model="formData.warehouseName"
                        placeholder="仓库"
                        clearable
                        filterable
                      >
                        <el-option
                          v-for="warehouse in warehouseOptions"
                          :key="warehouse.warehouseId"
                          :label="warehouse.warehouseName"
                          :value="warehouse.warehouseName"
                        />
                      </el-select>
                </el-form-item>
```

前端API

```

    getAllWarehouseOptions() {
      return request<any,WarehouseOptionVO[]>({
        url: `${AIOVEUWAREHOUSE_BASE_URL}/options`,
        method: "get",
      });
    }
    
    
    
export interface WarehouseOptionVO {
  warehouseId: number;
  warehouseName: string;
}
```



前端方法

```
 接口
  import AioveuWarehouseAPI, { WarehouseOptionVO } from "@/api/aioveuWarehouse/aioveu-warehouse";
  
  
  const warehouseOptions = ref<WarehouseOptionVO[]>([]);
  
  
  
    // 加载选项
  function loadWarehouseOptions() {
    AioveuWarehouseAPI.getAllWarehouseOptions().then(response => {
      warehouseOptions.value = response
    })
  }
  
  
      onMounted(() => {
    handleQuery();
    //在 onMounted钩子中调用了 loadDepartments()函数,确保函数被正确使用
    loadWarehouseOptions();
  });
```



# 9.获取部门列表

前端API

```
      /**
       * 获取所有部门列表（用于下拉选择框）
       * @returns 部门选项列表
       * 因为request函数的类型定义允许第一个类型参数为any，从而绕过了类型检查
       */
      getAllDepartmentOptions() {
        return request<any,DeptOptionVO[]>({
          url: `${AIOVEUDEPARTMENT_BASE_URL}/options`,
          method: "get",
        });
      },
      
   /** 部门选项VO（用于下拉选择框） */
export interface DeptOptionVO {
  /** 部门ID */
  deptId: number;
  /** 部门名称 */
  deptName: string;
}   
      
```



前端方法

```
 接口
  import AioveuDepartmentAPI, { DeptOptionVO } from "@/api/aioveuDepartment/aioveu-department";
  
  
  const deptOptions = ref<DeptOptionVO[]>([]);
  
  
  
    // 加载选项
  function loadDeptOptions() {
    AioveuDepartmentAPI.getAllDepartmentOptions().then(response => {
      deptOptions.value = response
    })
  }
  
  
      onMounted(() => {
    handleQuery();
    //在 onMounted钩子中调用了 loadDepartments()函数,确保函数被正确使用
    loadDeptOptions();
  });
```

表单

```

                <el-form-item label="仓库" prop="warehouseName">
                      <el-select
                        v-model="queryParams.warehouseName"
                        placeholder="仓库"
                        clearable
                        filterable
                        @keyup.enter="handleQuery()"
                      >
                        <el-option
                          v-for="warehouse in warehouseOptions"
                          :key="warehouse.warehouseId"
                          :label="warehouse.warehouseName"
                          :value="warehouse.warehouseName"
                        />
                      </el-select>
                </el-form-item>
               
                
                  <el-form-item label="领用部门" prop="departmentName">
                      <el-select
                        v-model="formData.departmentName"
                        placeholder="领用部门"
                        clearable
                        filterable
                      >
                        <el-option
                          v-for="dept in deptOptions"
                          :key="dept.deptId"
                          :label="dept.deptName"
                          :value="dept.deptName"
                        />
                      </el-select>
                </el-form-item>
```



# 10.获取员工列表

前端API

```
    getAllEmployeeOptions() {
      return request<any,EmployeeOptionVO[]>({
        url: `${AIOVEUEMPLOYEE_BASE_URL}/options`,
        method: "get",
      });
    }
    
    
    
export interface EmployeeOptionVO {
  employeeId: number;
  employeeName: string;
}
```

前端方法

```
 接口
  import AioveuEmployeeAPI, { EmployeeOptionVO } from "@/api/aioveuEmployee/aioveu-employee";
  
  
  const employeeOptions = ref<EmployeeOptionVO[]>([]);
  
  
  
    // 加载选项
  function loadEmployeeOptions() {
    AioveuEmployeeAPI.getAllEmployeeOptions().then(response => {
      employeeOptions.value = response
    })
  }
  
  
      onMounted(() => {
    handleQuery();
    //在 onMounted钩子中调用了 loadDepartments()函数,确保函数被正确使用
    loadEmployeeOptions();
  });
```

表单

```

                <el-form-item label="领用人" prop="recipientName">
                      <el-select
                        v-model="queryParams.recipientName"
                        placeholder="领用人"
                        clearable
                        filterable
                        @keyup.enter="handleQuery()"
                      >
                        <el-option
                          v-for="employee in employeeOptions"
                          :key="employee.employeeId"
                          :label="employee.employeeName"
                          :value="employee.employeeName"
                        />
                      </el-select>
                </el-form-item>
               
                
                  <el-form-item label="领用人" prop="recipientName">
                      <el-select
                        v-model="formData.recipientName"
                        placeholder="领用人"
                        clearable
                        filterable
                      >
                        <el-option
                          v-for="employee in employeeOptions"
                          :key="employee.employeeId"
                          :label="employee.employeeName"
                          :value="employee.employeeName"
                        />
                      </el-select>
                </el-form-item>
```



# 12.获取物资分类列表







前端API

```
/**
 * 获取所有分类列表（用于下拉选择框）
 * @returns 分类选项列表
 * 因为request函数的类型定义允许第一个类型参数为any，从而绕过了类型检查
 */
getAllCategoryOptions() {
  return request<any,CategoryOptionVO[]>({
    url: `${AIOVEUCATEGORY_BASE_URL}/options`,
    method: "get",
  });
}

/** 分类选项VO（用于下拉选择框） */
export interface CategoryOptionVO {
  /** 分类ID */
  categoryId: number;
  /** 分类名称 */
  categoryName: string;
}




```





方法

```
 
 
     import AioveuCategoryAPI, {CategoryOptionVO} from "@/api/aioveuCategory/aioveu-category";
 
 
     // 新增：父分类选项
  const parentCategoryOptions = ref<CategoryOptionVO[]>([]);
  
    const categoryOptions = ref<CategoryOptionVO[]>([]);
 
 // 加载选项
  function loadParentCategoryOptions() {
    AioveuCategoryAPI.getAllCategoryOptions().then(response => {
      parentCategoryOptions.value = response
    })
  }
  
   // 加载选项
  function loadCategoryOptions() {
    AioveuCategoryAPI.getAllCategoryOptions().then(response => {
      categoryOptions.value = response
    })
  }
  
  
      onMounted(() => {
    handleQuery();
    //在 onMounted钩子中调用了 loadDepartments()函数,确保函数被正确使用
    loadParentCategoryOptions();
    
    loadCategoryOptions();
  });
```



表单

```
                  <el-form-item label="分类名称" prop="name">
                      <el-select
                        v-model="queryParams.name"
                        placeholder="分类名称"
                        clearable
                        filterable
                        @keyup.enter="handleQuery()"
                      >
                        <el-option
                          v-for="category in categoryOptions"
                          :key="category.categoryId"
                          :label="category.categoryName"
                          :value="category.categoryName"
                        />
                      </el-select>
                </el-form-item>
               
                           
               
               
               <el-form-item label="父分类" prop="parentCategoryName">
                  <el-select
                    v-model="formData.parentCategoryName"
                    placeholder="请选择父分类"
                    clearable
                    filterable
                  >
                    <el-option
                      v-for="category in parentCategoryOptions"
                      :key="category.categoryId"
                      :label="category.categoryName"
                      :value="category.categoryName"
                    />
                  </el-select>
                </el-form-item>
```



# 13.获取岗位名称

前端API



```
    getAllPositionOptions() {
      return request<any,PositionOptionVO[]>({
        url: `${AIOVEUPOSITION_BASE_URL}/options`,
        method: "get",
      });
    },
    
    /** 岗位选项VO（用于下拉选择框） */
export interface PositionOptionVO {
  /** 岗位ID */
  positionId: number;
  /** 岗位名称 */
  positionName: string;
}
    
```

方法



```
 
 
     import AioveuPositionAPI, {PositionOptionVO} from "@/api/aioveuPosition/aioveu-position";
 
 
  const positionOptions = ref<PositionOptionVO[]>([]);
 
 // 加载选项
  function loadPositionOptions() {
    AioveuPositionAPI.getAllPositionOptions().then(response => {
      positionOptions.value = response
    })
  }
  
  
      onMounted(() => {
    handleQuery();
    //在 onMounted钩子中调用了 loadDepartments()函数,确保函数被正确使用
    loadPositionOptions();
  });
```



表单

```

                <el-form-item label="岗位名称" prop="positionName">
                      <el-select
                        v-model="queryParams.positionName"
                        placeholder="岗位名称"
                        clearable
                        filterable
                        @keyup.enter="handleQuery()"
                      >
                        <el-option
                          v-for="position in positionOptions"
                          :key="position.positionId"
                          :label="position.positionName"
                          :value="position.positionName"
                        />
                      </el-select>
                </el-form-item>
               
                
                  <el-form-item label="领用人" prop="recipientName">
                      <el-select
                        v-model="formData.recipientName"
                        placeholder="领用人"
                        clearable
                        filterable
                      >
                        <el-option
                          v-for="employee in employeeOptions"
                          :key="employee.employeeId"
                          :label="employee.employeeName"
                          :value="employee.employeeName"
                        />
                      </el-select>
                </el-form-item>
```



# 14.获取客户列表

前端API



```
    getAllCustomerOptions() {
      return request<any,CustomerOptionVO[]>({
        url: `${AIOVEUCUSTOMER_BASE_URL}/options`,
        method: "get",
      });
    },
    

export interface CustomerOptionVO {
  customerId: number;
  customerName: string;
}
```

方法



```
 
 
     import AioveuCustomerAPI, {CustomerOptionVO} from "@/api/aioveuCustomer/aioveu-customer";
 
 
  const customerOptions = ref<CustomerOptionVO[]>([]);
 
 // 加载选项
  function loadCustomerOptions() {
    AioveuCustomerAPI.getAllCustomerOptions().then(response => {
      customerOptions.value = response
    })
  }
  
  
      onMounted(() => {
    handleQuery();
    //在 onMounted钩子中调用了 loadDepartments()函数,确保函数被正确使用
    loadCustomerOptions();
  });
```



表单

```

                <el-form-item label="客户名称" prop="name">
                      <el-select
                        v-model="queryParams.name"
                        placeholder="客户名称"
                        clearable
                        filterable
                        @keyup.enter="handleQuery()"
                      >
                        <el-option
                          v-for="customer in customerOptions"
                          :key="customer.customerId"
                          :label="customer.customerName"
                          :value="customer.customerName"
                        />
                      </el-select>
                </el-form-item>
               
                
                  <el-form-item label="客户名称" prop="name">
                      <el-select
                        v-model="formData.name"
                        placeholder="客户名称"
                        clearable
                        filterable
                      >
                        <el-option
                          v-for="customer in customerOptions"
                          :key="customer.customerId"
                          :label="customer.customerName"
                          :value="customer.customerName"
                        />
                      </el-select>
                </el-form-item>
```



# 15.获取联系人列表

前端API



```
    getAllContactOptions() {
      return request<any,ContactOptionVO[]>({
        url: `${AIOVEUCONTACT_BASE_URL}/options`,
        method: "get",
      });
    },
    

export interface ContactOptionVO {
  contactId: number;
  contactName: string;
}
```

方法

```
 
     import AioveuContactAPI, {ContactOptionVO} from "@/api/aioveuContact/aioveu-contact";
 
 
  const contactOptions = ref<ContactOptionVO[]>([]);
 
 // 加载选项
  function loadContactOptions() {
    AioveuContactAPI.getAllContactOptions().then(response => {
      contactOptions.value = response
    })
  }
  
  
      onMounted(() => {
    handleQuery();
    //在 onMounted钩子中调用了 loadDepartments()函数,确保函数被正确使用
    loadContactOptions();
  });
```

表单



```

                <el-form-item label="联系人姓名" prop="name">
                      <el-select
                        v-model="queryParams.name"
                        placeholder="联系人姓名"
                        clearable
                        filterable
                        @keyup.enter="handleQuery()"
                      >
                        <el-option
                          v-for="contact in contactOptions"
                          :key="contact.contactId"
                          :label="contact.contactName"
                          :value="contact.contactName"
                        />
                      </el-select>
                </el-form-item>
               
                
                  <el-form-item label="联系人姓名" prop="name">
                      <el-select
                        v-model="formData.name"
                        placeholder="联系人姓名"
                        clearable
                        filterable
                      >
                        <el-option
                          v-for="contact in contactOptions"
                          :key="contact.contactId"
                          :label="contact.contactName"
                          :value="contact.contactName"
                        />
                      </el-select>
                </el-form-item>
```

# 16.获取订单列表



前端API

```
    getAllSalesOrderOptions() {
      return request<any,SalesOrderOptionVO[]>({
        url: `${AIOVEUSALESORDER_BASE_URL}/options`,
        method: "get",
      });
    },
    

export interface SalesOrderOptionVO {
  salesOrderId: number;
  salesOrderNo: string;
}
```

方法

```
 
     import AioveuSalesOrderAPI, {SalesOrderOptionVO} from "@/api/aioveuSalesOrder/aioveu-sales-order";
 
 
  const salesOrderOptions = ref<SalesOrderOptionVO[]>([]);
 
 // 加载选项
  function loadSalesOrderOptions() {
    AioveuSalesOrderAPI.getAllSalesOrderOptions().then(response => {
      salesOrderOptions.value = response
    })
  }
  
  
      onMounted(() => {
    handleQuery();
    //在 onMounted钩子中调用了 loadDepartments()函数,确保函数被正确使用
    loadSalesOrderOptions();
  });
```

表单

```

                <el-form-item label="订单" prop="orderName">
                      <el-select
                        v-model="queryParams.orderName"
                        placeholder="订单"
                        clearable
                        filterable
                        @keyup.enter="handleQuery()"
                      >
                        <el-option
                          v-for="salesOrder in salesOrderOptions"
                          :key="salesOrder.salesOrderId"
                          :label="salesOrder.salesOrderNo"
                          :value="salesOrder.salesOrderNo"
                        />
                      </el-select>
                </el-form-item>
               
                
                  <el-form-item label="订单" prop="name">
                      <el-select
                        v-model="formData.name"
                        placeholder="订单"
                        clearable
                        filterable
                      >
                        <el-option
                          v-for="salesOrder in salesOrderOptions"
                          :key="salesOrder.salesOrderId"
                          :label="salesOrder.salesOrderNo"
                          :value="salesOrder.salesOrderNo"
                        />
                      </el-select>
                </el-form-item>
```



# 17.Uniapp路径

uniapp

```
{
  title: "人员管理",
  children: [
    {
      icon: "/static/icons/logo.png",
      title: "部门管理",
      url: "/pages/aioveu_department/department/index",
      prem: "aioveuDepartment:aioveu-department:query",
    },
    {
      icon: "/static/icons/logo.png",
      title: "岗位管理",
      url: "/pages/aioveu_department/position/index",
      prem: "aioveuPosition:aioveu-position:query",
    },
    {
      icon: "/static/icons/logo.png",
      title: "员工管理",
      url: "/pages/aioveu_department/employee/index",
      prem: "aioveuEmployee:aioveu-employee:query",
    },
    {
      icon: "/static/icons/logo.png",
      title: "考勤管理",
      url: "/pages/aioveu_department/attendance/index",
      prem: "aioveuAttendance:aioveu-attendance:query",
    },
    {
      icon: "/static/icons/logo.png",
      title: "绩效管理",
      url: "/pages/aioveu_department/performance/index",
      prem: "aioveuPerformance:aioveu-performance:query",
    },
    {
      icon: "/static/icons/logo.png",
      title: "薪资管理",
      url: "/pages/aioveu_department/salary/index",
      prem: "aioveuSalary:aioveu-salary:query",
    },
  ],
},
{
  title: "物资管理",
  children: [
    {
      icon: "/static/icons/logo.png",
      title: "物资分类管理",
      url: "/pages/aioveu_material/category/index",
      prem: "aioveuCategory:aioveu-category:query",
    },
    {
      icon: "/static/icons/logo.png",
      title: "物资管理",
      url: "/pages/aioveu_material/material/index",
      prem: "aioveuMaterial:aioveu-material:query",
    },
    {
      icon: "/static/icons/logo.png",
      title: "仓库管理",
      url: "/pages/aioveu_material/warehouse/index",
      prem: "aioveuWarehouse:aioveu-warehouse:query",
    },
    {
      icon: "/static/icons/logo.png",
      title: "库存管理",
      url: "/pages/aioveu_material/inventory/index",
      prem: "aioveuInventory:aioveu-inventory:query",
    },
    {
      icon: "/static/icons/logo.png",
      title: "入库管理",
      url: "/pages/aioveu_material/inbound/index",
      prem: "aioveuInbound:aioveu-inbound:query",
    },
    {
      icon: "/static/icons/logo.png",
      title: "设备管理",
      url: "/pages/aioveu_material/equipment/index",
      prem: "aioveuEquipment:aioveu-equipment:query",
    },
    {
      icon: "/static/icons/logo.png",
      title: "采购管理",
      url: "/pages/aioveu_material/procurement/index",
      prem: "aioveu:aioveu-procurement:query",
    },
    {
      icon: "/static/icons/logo.png",
      title: "出库管理",
      url: "/pages/aioveu_material/outbound/index",
      prem: "aioveuOutbound:aioveu-outbound:query",
    },
  ],
},
{
  title: "客户管理",
  children: [
    {
      icon: "/static/icons/logo.png",
      title: "客户管理",
      url: "/pages/aioveu_customer/customer/index",
      prem: "aioveuCustomer:aioveu-customer:query",
    },
    {
      icon: "/static/icons/logo.png",
      title: "联系人管理",
      url: "/pages/aioveu_customer/contact/index",
      prem: "aioveuContact:aioveu-contact:query",
    },
    {
      icon: "/static/icons/logo.png",
      title: "交易管理",
      url: "/pages/aioveu_customer/transaction/index",
      prem: "aioveuTransaction:aioveu-transaction:query",
    },
    {
      icon: "/static/icons/logo.png",
      title: "订单管理",
      url: "/pages/aioveu_customer/sales_order/index",
      prem: "aioveuSalesOrder:aioveu-sales-order:query",
    },
    {
      icon: "/static/icons/logo.png",
      title: "订单明细管理",
      url: "/pages/aioveu_customer/sales_order_detail/index",
      prem: "aioveuSalesOrderDetail:aioveu-sales-order-detail:query",
    },
  ],
},
```
