

## 项目代码生成(前后端代码)



### 创建数据表

在数据库中执行以下 SQL 脚本以创建 **员工表**：

![](F:\Coding\Github\aioveu-boot-doc\代码生成\9.png)



### 启动项目

- **启动后端项目**：aioveu-boot

- **启动前端项目**：aioveu-vue3-element-admin
- 在启动前端项目之前，需要修改 `.env.development` 文件中的接口地址为本地开发环境的后端服务地址。

### 生成代码



**进入前端页面的代码生成器** 在前端项目中找到 `代码生成` 菜单，选择 `aioveu_department` 表，点击生成代码。



![](F:\Coding\Github\aioveu-boot-doc\代码生成\10.png)



**填写基础配置信息**

- **业务名**：公司部门组织结构
- **主包名**：com.aioveu.boot
- **模块名**：aioveuDepartment
- **实体名**：AioveuDepartment
- 如果需要自动生成会员模块的菜单和按钮权限，请选择对应的上级菜单。



![](F:\Coding\Github\aioveu-boot-doc\代码生成\11.png)



**配置字段信息**

- 配置筛选、列表和表单的字段。
- 可选择字段类型，例如文本框、下拉框等。
- 如果字段需要字典支持，可以配置字典信息。

![](F:\Coding\Github\aioveu-boot-doc\代码生成\12.png)



![](F:\Coding\Github\aioveu-boot-doc\代码生成\24.png)



切记id不要必填

### 核心原则

- 前端不生成ID：ID应由后端或数据库生成
- **前端不传递ID**：新增请求中不应包含ID字段
- **后端负责ID生成**：确保ID符合数据库约束

## 前端实现方案

### 1. 表单设计（避免ID字段）

### 2.提交逻辑（不包含ID）



## 后端实现方案

### 1.DTO/Form对象（无ID字段）

### 2.实体类设计（ID自增）

### 3. 控制器实现





## 完整工作流程

1. 用户在前端填写表单（不包含ID字段）
2. 前端验证表单数据
3. 前端发送POST请求到`/api/v1/aioveu-department`
4. 后端验证请求体不为空
5. 后端验证表单数据有效性
6. 后端转换DTO到实体（不设置ID）
7. 保存实体到数据库（ID由数据库生成）
8. 返回成功响应给前端
9. 前端显示成功消息并重置表单

通过这种设计，前端完全不需要处理ID生成问题，数据库约束也能得到满足，同时保证了系统的健壮性和可维护性。

**在线预览和下载代码**

- 配置完成后，可以在线预览生成的前后端代码。
- 下载生成的代码压缩包到本地。



前后端代码





```
vue3-element-admin
├── src                             
│   ├── api
│   │   ├── aioveuDepartment
│   │   │   ├── aioveu-department.ts
│   ├── views
│   │   ├── aioveuDepartment
│   │   │   ├── aioveu-department
│   │   │   │   ├── index.vue

aioveu-boot
├── src /main                            
│   ├── java
│   │   ├── com/aioveu/boot/aioveuDepartment
│   │   │   ├── controller
│   │   │   │   ├── AioveuDepartmentController.java
│   │   │   ├── service
│   │   │   │   ├── AioveuDepartmentService.java
│   │   │   │   ├── impl
│   │   │   │   │   ├── AioveuDepartmentServiceImpl.java
│   │   │   ├── mapper
│   │   │   │   ├── AioveuDepartmentMapper.java
│   │   │   ├── converter
│   │   │   │   ├── AioveuDepartmentConverter.java
│   │   │   ├── model
│   │   │   │   ├── query
│   │   │   │   │   ├── AioveuDepartmentQuery.java
│   │   │   │   ├── form
│   │   │   │   │   ├── AioveuDepartmentForm.java
│   │   │   │   ├── vo
│   │   │   │   │   ├── AioveuDepartmentVO.java
│   │   │   │   ├── entity
│   │   │   │   │   ├── AioveuDepartment.java


│   ├── resources
│   │   ├── mapper
│   │   │   ├── aioveuDepartment
│   │   │   │   ├── AioveuDepartmentMapper.xml

```

### 集成代码

下载代码，解压得到前后端代码



![](F:\Coding\Github\aioveu-boot-doc\代码生成\14.png)



**后端代码集成**

- 解压下载的代码包，将后端代码复制到 `aioveu-boot` 项目对应的目录中。
- 确保项目重新加载新代码，并进行必要的构建和启动操作。



![](F:\Coding\Github\aioveu-boot-doc\代码生成\15.png)



![](F:\Coding\Github\aioveu-boot-doc\代码生成\16.png)



```

 ------------------------------------------------------------------------------------------  
 entity
     /**
     1.getById(id)方法：
     •这里的 id对应实体类中的 employeeId字段
     •MyBatis-Plus 会根据 @TableId注解自动映射
     2.updateById(entity)方法：
     •根据实体类中的 @TableId字段（employeeId）进行更新
     •不需要显式指定主键字段名
     3.employeeId字段：
     •在实体类中定义为 Long类型
     •使用 @TableId注解指定数据库列名
     */
     @TableId(value = "employee_id", type = IdType.AUTO)
     
  ------------------------------------------------------------------------------------------      
     
    /**
     * 创建时间 在实体类中添加双重注解
     */
    @TableField(fill = FieldFill.INSERT)
    @JsonInclude(value = JsonInclude.Include.NON_NULL)
    @JsonFormat(pattern = "yyyy-MM-dd HH:mm:ss")  //处理 JSON 序列化/反序列化
    @DateTimeFormat(pattern = "yyyy-MM-dd HH:mm:ss") //处理表单参数绑定 两者使用相同的日期格式
    private LocalDateTime createTime;

    /**
     * 更新时间 在实体类中添加双重注解
     */
    @TableField(fill = FieldFill.INSERT_UPDATE)
    @JsonInclude(value = JsonInclude.Include.NON_NULL)
    @JsonFormat(pattern = "yyyy-MM-dd HH:mm:ss")  //处理 JSON 序列化/反序列化
    @DateTimeFormat(pattern = "yyyy-MM-dd HH:mm:ss")  //处理表单参数绑定 两者使用相同的日期格式
    private LocalDateTime updateTime;
 ------------------------------------------------------------------------------------------      
 修改后端表单类（移除employeeId）   
4. 清理并重建项目
在 IDE 中执行清理和重建操作：
•IntelliJ：Build > Rebuild Project

如果不行找不到类，就重新打开


import lombok.extern.slf4j.Slf4j;

@Slf4j

当前更新方法没有设置实体对象的ID，也没有处理任何业务逻辑（如唯一性检查、复制未修改字段等）修复这个问题

        // 1. 验证ID对应的记录是否存在
        Aioveu original = getById(id);
        if (original == null) {
            log.error("记录不存在: ID={}", id);
            throw new ServiceException("记录不存在");   
            
        }
        
       // 2. 将表单数据转换为实体对象
        Aioveu entity = aioveuAttendanceConverter.toEntity(formData);

        // 3. 设置ID
        entity.setId(id);

        // 4. 复制未修改的字段,保留审计字段(创建时间不变，更新时间用当前时间)
        entity.setCreateTime(original.getCreateTime());
        
        // 5. 执行更新
        
        
        物资表CRUD,update接口设置ID
        
        物资表前端
 ------------------------------------------------------------------------------------------       
    
 前端
     /** 创建时间 */
    createdAt?: string;
    /** 更新时间 */
    updatedAt?: string;
    
 ------------------------------------------------------------------------------------------   
 
 export interface AioveuEmployeeForm {

  修改表单数据类型（移除employeeId）  
 ------------------------------------------------------------------------------------------     
// 表单数据 修改表单数据初始化
  const formData = reactive<AioveuPositionForm>({


    positionName:  '',
    /** 所属部门ID */
    deptId:  undefined,
    /** 职级(1-10) */
    positionLevel:  undefined,
    /** 岗位描述 */
    description:  undefined

  });
------------------------------------------------------------------------------------------   
//表单校验规则 rules
------------------------------------------------------------------------------------------   
  /** 查询信息 */ handleQuery
------------------------------------------------------------------------------------------   
  /** 重置信息查询 */handleResetQuery
------------------------------------------------------------------------------------------   
/** 行复选框选中记录选中ID集合 */ handleSelectionChange

  function handleSelectionChange(selection: AioveuDepartmentPageVO[]) {
    removeIds.value = selection
      .map(item => item.deptId)
      .filter((deptId): deptId is number => deptId !== undefined && deptId !== null) as number[];
  } 
  
    function handleSelectionChange(selection: AioveuPerformancePageVO[]) {
    removeIds.value = selection
      .map(item => item.id)
      .filter((id): id is number => id !== undefined && id !== null) as number[];
  }
-----------------------------------------------------------------------------------------   
// 在组件中添加一个变量存储当前编辑的ID
const editingEmployeeId = ref<number | undefined>(undefined);
-----------------------------------------------------------------------------------------   
/** 打开信息弹窗 */ handleOpenDialog

editingEmployeeId.value = employeeId; // 保存ID

  if (employeeId) {
    dialog.title = "修改员工信息";
    
    
-----------------------------------------------------------------------------------------   
/** 提交信息表单 */ handleSubmit
    if (valid) {
      loading.value = true;
      const id = editingEmployeeId.value; // 使用存储的ID
------------------------------------------------------------------------------------------  
/** 关闭信息弹窗 */ handleCloseDialog

// 关键修复：在关闭弹窗时重置加载状态
loading.value = false; 

// 清除编辑ID
  editingEmployeeId.value = undefined; 
------------------------------------------------------------------------------------------  
/** 删除信息 */ handleDelete
------------------------------------------------------------------------------------------  
```

**前端代码集成**

- 同样将前端代码复制到前端项目中对应的目录。



![](F:\Coding\Github\aioveu-boot-doc\代码生成\17.png)



### 功能测试



#### 功能测试

进入 **菜单管理** 模块，新建菜单权限。



![](F:\Coding\Github\aioveu-boot-doc\代码生成\18.png)



![](F:\Coding\Github\aioveu-boot-doc\代码生成\19.png)



![](F:\Coding\Github\aioveu-boot-doc\代码生成\20.png)





在部门管理下新增一个按钮，比如说新增按钮，权限标识需要注意一下，第一它需要全局唯一，第二，他由三部分组成，第一部分：模块代码，第二部分，业务代码，第三个就是功能代码

![](F:\Coding\Github\aioveu-boot-doc\代码生成\21.png)







对于前端代码。新增一个自定义标识 <el-button v-hasPerm="['system:member:delete']",放在按钮上，也可以放在列上，这些就可以控制列是否显示，要跟菜单对应的标识一致，然后要重新登陆一下，系统会从登陆中获取权限



查询  v-hasPerm="['system:member:query]"

重置 v-hasPerm="['system:member:ResetQuery]"

新增  v-hasPerm="['system:member:add']"

编辑 v-hasPerm="['system:member:edit']"

删除 v-hasPerm="['system:member:delete']"

导入 v-hasPerm="['system:member:import']"

导出 v-hasPerm="['system:member:export]"

修改 v-hasPerm="['system:member:update]"

刷新 v-hasPerm="['system:member:refresh]"



![](F:\Coding\Github\aioveu-boot-doc\代码生成\22.png)







前端按钮权限隐藏，在后端做限制，在控制层的新增接口，按钮上使用一个注解来进行一些限制@PreAuthorize("@ss.hasPerm(' : : : ')")



在core/service/PermissionService里,这样即使有新增按钮，也会显示访问未授权，即使他抓住这个接口，也无法使用



进入 **角色管理** 模块，为当前用户的角色分配新生成的 **会员管理** 菜单权限。



![](F:\Coding\Github\aioveu-boot-doc\功能详解与操作手册\4操作指南\4.2.15.png)





刷新页面

![](F:\Coding\Github\aioveu-boot-doc\代码生成\23.png)







![](F:\Coding\Github\aioveu-boot-doc\功能详解与操作手册\4操作指南\4.2.16.png)



![](F:\Coding\Github\aioveu-boot-doc\功能详解与操作手册\4操作指南\4.2.17.png)



解决更新时间未变化问题



删除表单信息的后端校验，创建信息时，表单编号可以为空，由后端数据库自动生成

![](F:\Coding\Github\aioveu-boot-doc\功能详解与操作手册\4操作指南\4.2.18.png)

进入 **角色管理** 模块，为当前用户的角色分配新生成的 **会员管理** 菜单权限。
